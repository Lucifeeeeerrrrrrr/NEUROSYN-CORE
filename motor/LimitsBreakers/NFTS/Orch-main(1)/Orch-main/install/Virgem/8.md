
/**
 * Componente de navega√ß√£o entre se√ß√µes de API
 * Implementa princ√≠pio de Responsabilidade √önica (SRP) do SOLID
 * Simplificado para usar apenas Ollama
 */
interface ApiNavigationProps {
  openSection: "ollama" | null;
  setOpenSection: (section: "ollama" | null) => void;
}

export const ApiNavigation: React.FC<ApiNavigationProps> = ({
  openSection,
  setOpenSection,
}) => {
  return (
    <div className="mb-6 border-b border-cyan-900/40">
      <div className="flex space-x-6">
        <button
          type="button"
          className={`px-3 py-2 font-medium transition-colors border-b-2 ${
            openSection === "ollama"
              ? "text-cyan-300 border-cyan-500/70"
              : "text-cyan-500/60 border-transparent hover:text-cyan-400/80 hover:border-cyan-600/30"
          }`}
          onClick={() =>
            setOpenSection(openSection === "ollama" ? null : "ollama")
          }
        >
          ü¶ô Ollama Local Models
        </button>
      </div>
    </div>
  );
};

export default ApiNavigation;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React, { useEffect, useState } from "react";
import { OrchOSModeEnum } from "../../../../../../services/ModeService";
import {
  getOption,
  setOption,
  STORAGE_KEYS,
} from "../../../../../../services/StorageService";
import { getModelDimensions } from "../../../../../../utils/EmbeddingUtils";
import { HuggingFaceSettingsProps } from "./types";

const HF_EMBEDDING_MODELS = ["Xenova/all-MiniLM-L6-v2"];

/**
 * Componente para configura√ß√µes do modo b√°sico
 * Implementa princ√≠pio de Responsabilidade √önica (SRP) do SOLID
 * Symbolic: Neur√¥nios de interface para configura√ß√£o cognitiva local
 */
export const BasicModeSettings: React.FC<HuggingFaceSettingsProps> = ({
  setApplicationMode,
  hfModel,
  setHfModel,
  hfEmbeddingModel,
  setHfEmbeddingModel,
  hfModelOptions = [],
  hfEmbeddingModelOptions = [],
}) => {
  // Estado para o caminho do DuckDB
  const [duckDbPath, setDuckDbPath] = useState<string>(
    () => getOption<string>(STORAGE_KEYS.DUCKDB_PATH) || "./orch-os-memory"
  );

  // Estado para ferramentas habilitadas
  const [toolsEnabled, setToolsEnabled] = useState<boolean>(
    () => getOption<boolean>(STORAGE_KEYS.TOOLS_ENABLED) ?? true
  );

  // Carregar configura√ß√£o salva na inicializa√ß√£o
  useEffect(() => {
    const savedPath = getOption<string>(STORAGE_KEYS.DUCKDB_PATH);
    if (savedPath) {
      setDuckDbPath(savedPath);
    }
  }, []);

  // Handler para sele√ß√£o de diret√≥rio
  const handleBrowseDirectory = async () => {
    try {
      // Verificar se estamos no Electron
      if (typeof window !== "undefined" && (window as any).electronAPI) {
        const result = await (window as any).electronAPI.selectDirectory();

        if (result.success && result.path) {
          const newPath = result.path;
          setDuckDbPath(newPath);
          setOption(STORAGE_KEYS.DUCKDB_PATH, newPath);
          console.log("üìÅ [SETTINGS] DuckDB path updated:", newPath);

          // Reinicializar DuckDB com o novo caminho
          try {
            const reinitResult = await (
              window as any
            ).electronAPI.reinitializeDuckDB(newPath);
            if (reinitResult.success) {
              console.log(
                "‚úÖ [SETTINGS] DuckDB successfully reinitialized with new path"
              );
            } else {
              console.error(
                "‚ùå [SETTINGS] Failed to reinitialize DuckDB:",
                reinitResult.error
              );
            }
          } catch (reinitError) {
            console.error(
              "‚ùå [SETTINGS] Error reinitializing DuckDB:",
              reinitError
            );
          }
        } else if (!result.canceled) {
          console.error(
            "‚ùå [SETTINGS] Failed to select directory:",
            result.error
          );
        }
      } else {
        console.warn(
          "‚ö†Ô∏è [SETTINGS] Directory selection not available in web mode"
        );
      }
    } catch (error) {
      console.error("‚ùå [SETTINGS] Error selecting directory:", error);
    }
  };

  // Handler para mudan√ßa manual do caminho
  const handlePathChange = async (newPath: string) => {
    setDuckDbPath(newPath);
    setOption(STORAGE_KEYS.DUCKDB_PATH, newPath);

    // Reinicializar DuckDB apenas se estamos no Electron e o caminho n√£o est√° vazio
    if (
      typeof window !== "undefined" &&
      (window as any).electronAPI &&
      newPath.trim()
    ) {
      try {
        const reinitResult = await (
          window as any
        ).electronAPI.reinitializeDuckDB(newPath);
        if (reinitResult.success) {
          console.log(
            "‚úÖ [SETTINGS] DuckDB successfully reinitialized with new path"
          );
        } else {
          console.error(
            "‚ùå [SETTINGS] Failed to reinitialize DuckDB:",
            reinitResult.error
          );
        }
      } catch (reinitError) {
        console.error(
          "‚ùå [SETTINGS] Error reinitializing DuckDB:",
          reinitError
        );
      }
    }
  };
  return (
    <div className="p-3 rounded-lg bg-black/30 border border-cyan-500/20">
      <div className="flex items-center mb-2">
        <div className="w-8 h-8 flex items-center justify-center rounded-full bg-gradient-to-r from-cyan-500/30 to-blue-500/30 mr-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            viewBox="0 0 16 16"
            className="text-cyan-300"
          >
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
            <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
          </svg>
        </div>
        <h3 className="text-lg font-medium text-cyan-300">
          Basic Mode Services
        </h3>
      </div>

      <div className="space-y-3">
        {/* Reutilizando o componente HuggingFaceSettings aqui seria mais elegante,
            mas para manter a exata apar√™ncia do componente original, mantive a implementa√ß√£o direta */}
        <div className="bg-black/40 p-2 rounded-md">
          <h4 className="text-cyan-400 font-medium mb-1">
            Hugging Face Text Models
          </h4>
          <p className="text-white/70 text-sm">
            Select a local text-generation model for your Orch-OS instance. Only
            browser-compatible models are shown.
          </p>
          <div className="mt-2">
            <select
              className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
              title="Select HuggingFace Model"
              aria-label="Select HuggingFace Model"
              value={hfModel}
              onChange={(e) => {
                setHfModel(e.target.value);
              }}
            >
              {hfModelOptions.map((model) => (
                <option key={model.id} value={model.id}>
                  {model.label}
                </option>
              ))}
            </select>
          </div>
        </div>

        <div className="bg-black/40 p-2 rounded-md">
          <h4 className="text-cyan-400 font-medium mb-1">
            Hugging Face Embedding Models{" "}
            <span className="text-xs text-cyan-500/70">(Basic Mode)</span>
          </h4>
          <p className="text-white/70 text-sm">
            Select a local model for generating vector embeddings in the neural
            memory database.
          </p>
          <div className="mt-2">
            <select
              className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
              title="Select HuggingFace Embedding Model"
              aria-label="Select HuggingFace Embedding Model"
              value={hfEmbeddingModel}
              onChange={(e) => {
                setHfEmbeddingModel(e.target.value);
              }}
            >
              {hfEmbeddingModelOptions.map((model) => (
                <option key={model.id} value={model.id}>
                  {model.label} ({getModelDimensions(model.id)}d)
                </option>
              ))}
            </select>
            <p className="text-xs text-cyan-400/60 mt-1">
              Modelo utilizado para gerar embeddings e busca sem√¢ntica na
              mem√≥ria no modo b√°sico.
            </p>
          </div>
        </div>

        <div className="bg-black/40 p-2 rounded-md">
          <h4 className="text-cyan-400 font-medium mb-1">
            Memory Storage Location
          </h4>
          <p className="text-white/70 text-sm">
            Directory where your neural memory database will be stored locally.
          </p>
          <div className="mt-2 flex">
            <input
              type="text"
              className="flex-1 p-2 rounded-l bg-black/40 text-white/90 border border-cyan-500/30"
              value={duckDbPath}
              onChange={(e) => handlePathChange(e.target.value)}
              title="Memory storage directory"
              aria-label="Memory storage directory"
              placeholder="Enter or browse for directory path"
            />
            <button
              className="bg-cyan-600/30 hover:bg-cyan-500/40 text-cyan-300 rounded-r px-3 border border-cyan-500/30 transition-colors"
              onClick={handleBrowseDirectory}
              title="Browse for directory"
            >
              Browse
            </button>
          </div>
          <p className="text-xs text-cyan-400/60 mt-1">
            DuckDB will automatically manage the vector database at this
            location.
          </p>
        </div>
      </div>

      <div className="mt-3 flex justify-end">
        <button
          type="button"
          className="w-full bg-gradient-to-r from-purple-500/20 to-cyan-500/20 text-purple-300 border border-purple-500/30 rounded-lg py-2 mt-3 hover:from-purple-500/30 hover:to-cyan-500/30 transition-all shadow-[0_0_10px_rgba(200,0,255,0.2)] backdrop-blur-sm"
          onClick={() =>
            setApplicationMode && setApplicationMode(OrchOSModeEnum.ADVANCED)
          }
        >
          ü¶ô Switch to Advanced Mode (Ollama)
        </button>
      </div>
    </div>
  );
};

export default BasicModeSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { OrchOSModeEnum } from "../../../../../../services/ModeService";
import {
  setOption,
  STORAGE_KEYS,
} from "../../../../../../services/StorageService";
import { ChatGPTSettingsProps } from "./types";

// Modelos de embedding OpenAI suportados
const SUPPORTED_OPENAI_EMBEDDING_MODELS = [
  "text-embedding-ada-002",
  "text-embedding-3-small",
  "text-embedding-3-large",
];

/**
 * Componente para configura√ß√£o da integra√ß√£o com ChatGPT/OpenAI
 * Implementa princ√≠pio de Responsabilidade √önica (SRP) do SOLID
 */
export const ChatGPTSettings: React.FC<ChatGPTSettingsProps> = ({
  applicationMode,
  chatgptApiKey,
  setChatgptApiKey,
  chatgptModel,
  setChatgptModel,
  openaiEmbeddingModel,
  setOpenaiEmbeddingModel,
}) => {
  return (
    <div className="p-4 rounded-md bg-black/20 mb-4 animate-fade-in">
      <h3 className="text-lg text-cyan-300 mb-4">ChatGPT Integration</h3>
      <div className="space-y-4">
        <div>
          <label
            htmlFor="chatgptApiKey"
            className="block mb-1 text-sm text-cyan-200/80"
          >
            ChatGPT API Key
          </label>
          <input
            type="password"
            id="chatgptApiKey"
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            value={chatgptApiKey}
            onChange={(e) => {
              setChatgptApiKey(e.target.value);
              setOption(STORAGE_KEYS.OPENAI_API_KEY, e.target.value);
            }}
            placeholder="Enter your ChatGPT API key"
          />
        </div>

        <div>
          <label
            htmlFor="chatgptModel"
            className="block mb-1 text-sm text-cyan-200/80"
          >
            ChatGPT Model
          </label>
          <select
            id="chatgptModel"
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            value={chatgptModel}
            onChange={(e) => {
              setChatgptModel(e.target.value);
              setOption(STORAGE_KEYS.CHATGPT_MODEL, e.target.value);
            }}
            title="Select ChatGPT Model"
          >
            {/* Modelos ChatGPT em ordem cronol√≥gica de lan√ßamento */}
            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
            <option value="gpt-4">GPT-4</option>
            <option value="gpt-4-turbo">GPT-4 Turbo</option>
            <option value="gpt-4o-mini">GPT-4o Mini</option>
            <option value="gpt-4o">GPT-4o</option>
            <option value="gpt-4.1-nano">GPT-4.1 Nano</option>
            <option value="gpt-4.1-mini">GPT-4.1 Mini</option>
            <option value="gpt-4.1">GPT-4.1</option>
            <option value="gpt-4.5-preview">GPT-4.5 Preview</option>
          </select>
        </div>

        {/* OpenAI Embedding Model - apenas no modo avan√ßado */}
        {applicationMode === OrchOSModeEnum.ADVANCED && (
          <div>
            <label
              htmlFor="openaiEmbeddingModel"
              className="block mb-1 text-sm text-cyan-200/80"
            >
              OpenAI Embedding Model{" "}
              <span className="text-xs text-cyan-500/70">(Advanced Mode)</span>
            </label>
            <select
              id="openaiEmbeddingModel"
              className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
              value={openaiEmbeddingModel}
              onChange={(e) => {
                setOpenaiEmbeddingModel(e.target.value);
                setOption(STORAGE_KEYS.OPENAI_EMBEDDING_MODEL, e.target.value);
              }}
              title="Select OpenAI Embedding Model"
            >
              {SUPPORTED_OPENAI_EMBEDDING_MODELS.map((model) => (
                <option key={model} value={model}>
                  {model}
                </option>
              ))}
            </select>
            <p className="text-xs text-cyan-400/60 mt-1">
              Modelo utilizado para gerar embeddings e busca sem√¢ntica na
              mem√≥ria no modo avan√ßado.
            </p>
          </div>
        )}
      </div>
    </div>
  );
};

export default ChatGPTSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React, { useEffect } from 'react';
import { setOption, STORAGE_KEYS } from '../../../../../../services/StorageService';
import { useDeepgramLanguageCompatibility } from './hooks/useDeepgramLanguageCompatibility';
import { DeepgramSettingsProps } from './types';

/**
 * Componente para configura√ß√£o da integra√ß√£o com Deepgram
 * Implementa princ√≠pio de Responsabilidade √önica (SRP) do SOLID
 * Extrai l√≥gica de compatibilidade para um hook customizado
 * 
 * DEBUG: Adicionados logs tempor√°rios para diagn√≥stico de persist√™ncia
 */
const DeepgramSettings: React.FC<DeepgramSettingsProps> = React.memo(({
  deepgramApiKey,
  setDeepgramApiKey,
  deepgramModel,
  setDeepgramModel,
  deepgramLanguage,
  setDeepgramLanguage
}) => {
  // Hook para gerenciar compatibilidade entre modelo e idioma
  const { getCompatibleLanguages, getLanguageDisplay } = useDeepgramLanguageCompatibility();
  const compatibleLanguages = getCompatibleLanguages(deepgramModel);

  // Efeito para verificar e ajustar idioma quando o modelo muda
  useEffect(() => {
    // S√≥ ajuste se realmente necess√°rio
    const isCurrentLanguageCompatible = compatibleLanguages.includes(deepgramLanguage);
    const fallbackLanguage = compatibleLanguages[0];

    if (
      !isCurrentLanguageCompatible &&
      fallbackLanguage &&
      deepgramLanguage !== fallbackLanguage
    ) {
      console.log(
        `üåê Modelo ${deepgramModel} n√£o suporta idioma ${deepgramLanguage}, alterando para ${fallbackLanguage}`
      );
      setDeepgramLanguage(fallbackLanguage);
    }
    // Se j√° est√° compat√≠vel ou j√° √© o fallback, n√£o faz nada!
  }, [deepgramModel, deepgramLanguage, compatibleLanguages, setDeepgramLanguage]);

  // Move os logs para um useEffect para evitar logs em cada render
  useEffect(() => {
    console.log('[DeepgramSettings] deepgramModel alterado:', deepgramModel);
  }, [deepgramModel]);

  useEffect(() => {
    console.log('[DeepgramSettings] deepgramLanguage alterado:', deepgramLanguage);
  }, [deepgramLanguage]);

  return (
    <div className="p-3 rounded-md bg-black/20 mb-3 animate-fade-in">
      <h3 className="text-lg text-cyan-300 mb-2">Deepgram Voice Transcription</h3>
      <div className="space-y-3">
        <div>
          <label htmlFor="deepgramApiKey" className="block mb-1 text-sm text-cyan-200/80">Deepgram API Key</label>
          <input 
            type="password"
            id="deepgramApiKey"
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            value={deepgramApiKey}
            onChange={e => {
              setDeepgramApiKey(e.target.value);
              setOption(STORAGE_KEYS.DEEPGRAM_API_KEY, e.target.value);
            }}
            placeholder="Enter your Deepgram API key"
          />
        </div>
        
        <div>
          <label htmlFor="deepgramModel" className="block mb-1 text-sm text-cyan-200/80">Deepgram Model</label>
          <select
            id="deepgramModel"
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            value={deepgramModel}
            onChange={e => {
              console.log('Salvando modelo Deepgram:', e.target.value);
              setDeepgramModel(e.target.value);
              setOption(STORAGE_KEYS.DEEPGRAM_MODEL, e.target.value);
            }}
            title="Select Deepgram Model"
          >
            {/* Nova-3 - Latest and most advanced */}
            <optgroup label="Nova-3 Models">
              <option value="nova-3">Nova-3 General</option>
              <option value="nova-3-medical">Nova-3 Medical</option>
            </optgroup>
            
            {/* Nova-2 - Second generation */}
            <optgroup label="Nova-2 Models">
              <option value="nova-2">Nova-2 General (Recommended)</option>
              <option value="nova-2-meeting">Nova-2 Meeting</option>
              <option value="nova-2-phonecall">Nova-2 Phone Call</option>
              <option value="nova-2-video">Nova-2 Video</option>
            </optgroup>
            
            {/* Nova - First generation */}
            <optgroup label="Nova Models">
              <option value="nova">Nova General</option>
              <option value="nova-phonecall">Nova Phone Call</option>
            </optgroup>
            
            {/* Enhanced - Legacy models */}
            <optgroup label="Enhanced Models">
              <option value="enhanced">Enhanced General</option>
              <option value="enhanced-meeting">Enhanced Meeting</option>
              <option value="enhanced-phonecall">Enhanced Phone Call</option>
              <option value="enhanced-finance">Enhanced Finance</option>
            </optgroup>
            
            {/* Base - Basic models */}
            <optgroup label="Base Models">
              <option value="base">Base General</option>
              <option value="base-meeting">Base Meeting</option>
              <option value="base-phonecall">Base Phone Call</option>
              <option value="base-finance">Base Finance</option>
            </optgroup>
          </select>
        </div>
        
        {/* Compatibilidade modelo-idioma */}
        <div>
          <label htmlFor="deepgramLanguage" className="block mb-1 text-sm text-cyan-200/80">Transcription Language</label>
            
          {/* Seletor de idioma filtrado por compatibilidade com o modelo */}
          <select
            id="deepgramLanguage"
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            value={deepgramLanguage}
            onChange={e => {
              const newValue = e.target.value;
              setDeepgramLanguage(newValue);
              setOption(STORAGE_KEYS.DEEPGRAM_LANGUAGE, newValue);
            }}
            title="Select Transcription Language"
          >
            {compatibleLanguages.map(langCode => (
              <option key={langCode} value={langCode}>
                {getLanguageDisplay(langCode)}
              </option>
            ))}
          </select>
          
          {/* Exibir informa√ß√µes de compatibilidade */}
          {compatibleLanguages.length === 1 && compatibleLanguages[0] === 'en' && (
            <p className="text-xs text-amber-400 mt-1">
              Este modelo suporta apenas ingl√™s.
            </p>
          )}
          {compatibleLanguages.includes('multi') && (
            <p className="text-xs text-cyan-400/60 mt-1">
              Este modelo suporta detec√ß√£o autom√°tica de idioma.
            </p>
          )}
        </div>
      </div>
    </div>
  );
});

export default DeepgramSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import {
  setOption,
  STORAGE_KEYS,
} from "../../../../../../services/StorageService";
import { HuggingFaceSettingsProps } from "./types";

/**
 * Componente para configura√ß√£o de modelos do HuggingFace
 * Implementa princ√≠pio de Responsabilidade √önica (SRP) do SOLID
 */
export const HuggingFaceSettings: React.FC<HuggingFaceSettingsProps> = ({
  hfModel,
  setHfModel,
  hfEmbeddingModel,
  setHfEmbeddingModel,
}) => {
  // AI model options for HuggingFace
  const HF_MODELS = [
    {
      id: "Xenova/llama2.c-stories15M",
      label: "Llama2.c Stories (~15MB) - Ultra pequeno",
    },
    {
      id: "Xenova/distilgpt2",
      label: "DistilGPT-2 (~353MB) - Otimizado",
    },
    {
      id: "Xenova/gpt2",
      label: "GPT-2 Base (~548MB) - Est√°vel",
    },
    {
      id: "Xenova/TinyLlama-1.1B-Chat-v1.0",
      label: "TinyLlama Chat (~1.1B) - Modelo de chat",
    },
  ];

  const HF_EMBEDDING_MODELS = [
    {
      id: "Xenova/all-MiniLM-L6-v2",
      label: "all-MiniLM-L6-v2 (MiniLM 384d) ‚Äî Recomendado",
    },
  ];

  return (
    <div className="space-y-4">
      <div className="bg-black/40 p-4 rounded-md">
        <h4 className="text-cyan-400 font-medium mb-2">
          Hugging Face Text Models
        </h4>
        <p className="text-white/70 text-sm">
          Select a local text-generation model for your Orch-OS instance. Only
          browser-compatible models are shown.
        </p>
        <div className="mt-3">
          <select
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            title="Select HuggingFace Model"
            aria-label="Select HuggingFace Model"
            value={hfModel}
            onChange={(e) => {
              setHfModel(e.target.value);
              setOption(STORAGE_KEYS.HF_MODEL, e.target.value);
            }}
          >
            {HF_MODELS.map((m) => (
              <option key={m.id} value={m.id}>
                {m.label}
              </option>
            ))}
          </select>
        </div>
      </div>

      <div className="bg-black/40 p-4 rounded-md">
        <h4 className="text-cyan-400 font-medium mb-2">
          Hugging Face Embedding Models{" "}
          <span className="text-xs text-cyan-500/70">(Basic Mode)</span>
        </h4>
        <p className="text-white/70 text-sm">
          Select a local model for generating vector embeddings in the neural
          memory database.
        </p>
        <div className="mt-3">
          <select
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            title="Select HuggingFace Embedding Model"
            aria-label="Select HuggingFace Embedding Model"
            value={hfEmbeddingModel}
            onChange={(e) => {
              setHfEmbeddingModel(e.target.value);
              setOption(STORAGE_KEYS.HF_EMBEDDING_MODEL, e.target.value);
            }}
          >
            {HF_EMBEDDING_MODELS.map((m) => (
              <option key={m.id} value={m.id}>
                {m.label}
              </option>
            ))}
          </select>
          <p className="text-xs text-cyan-400/60 mt-1">
            Modelo utilizado para gerar embeddings e busca sem√¢ntica na mem√≥ria
            no modo b√°sico.
          </p>
        </div>
      </div>

      <div className="bg-black/40 p-4 rounded-md">
        <h4 className="text-cyan-400 font-medium mb-2">Local Storage</h4>
        <p className="text-white/70 text-sm">
          Storage location for your neural memory database.
        </p>
        <div className="mt-3 flex">
          <input
            type="text"
            className="flex-1 p-2 rounded-l bg-black/40 text-white/90 border border-cyan-500/30"
            value="./orch-os-memory"
            readOnly
            title="Local storage location"
            aria-label="Local storage location"
          />
          <button className="bg-cyan-600/30 hover:bg-cyan-500/40 text-cyan-300 rounded-r px-3 border border-cyan-500/30">
            Browse
          </button>
        </div>
      </div>
    </div>
  );
};

export default HuggingFaceSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

// Componentes principais para Ollama
export { default as ApiNavigation } from "./ApiNavigation";
export { default as BasicModeSettings } from "./BasicModeSettings";
export { default as OllamaSettings } from "./OllamaSettings";

// Componentes legados mantidos para compatibilidade (podem ser removidos gradualmente)
export { default as ChatGPTSettings } from "./ChatGPTSettings";
export { default as DeepgramSettings } from "./DeepgramSettings";
export { default as HuggingFaceSettings } from "./HuggingFaceSettings";
export { default as PineconeSettings } from "./PineconeSettings";

// Tipos
export * from "./types";
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import {
  ArrowDownTrayIcon,
  CheckCircleIcon,
  ChevronDownIcon,
  ExclamationTriangleIcon,
  TrashIcon,
  XMarkIcon,
} from "@heroicons/react/24/outline";
import React, { useCallback, useEffect, useState } from "react";

/* ------------------------------------------------------------------
 * Local helper types & globals
 * ------------------------------------------------------------------ */
// Lightweight copy of the vLLM status type (avoids deep relative import)
type VllmStatus = {
  state:
    | "idle"
    | "downloading"
    | "pulling_image"
    | "starting"
    | "ready"
    | "error";
  progress?: number;
  message?: string;
  modelId?: string;
};

// Static model definitions as requested by the user
const AVAILABLE_MODELS: OllamaModel[] = [
  // Main models that support tools/function calling
  {
    id: "qwen3:4b",
    name: "Qwen3 4B",
    description: "Advanced reasoning model with tools support",
    size: "2.6GB",
    category: "main",
    isDownloaded: false,
    isDownloading: false,
  },
  {
    id: "mistral:latest",
    name: "Mistral Latest",
    description: "Fast and efficient model with tools support",
    size: "4.1GB",
    category: "main",
    isDownloaded: false,
    isDownloading: false,
  },
  {
    id: "mistral-nemo:latest",
    name: "Mistral Nemo",
    description: "Optimized Mistral variant for tools and function calling",
    size: "5.5GB",
    category: "main",
    isDownloaded: false,
    isDownloading: false,
  },
  {
    id: "llama3.2:latest",
    name: "Llama 3.2 Latest",
    description: "Meta's latest model with excellent tools integration",
    size: "3.8GB",
    category: "main",
    isDownloaded: false,
    isDownloading: false,
  },
  // Embedding models (keeping as they might be needed for embeddings)
  {
    id: "bge-m3:latest",
    name: "BGE-M3 Latest",
    description:
      "Advanced multilingual embedding model (dense + sparse + multi-vector)",
    size: "2.4GB",
    category: "embedding",
    isDownloaded: false,
    isDownloading: false,
  },
  {
    id: "nomic-embed-text:latest",
    name: "Nomic Embed Text",
    description: "High-quality text embeddings",
    size: "274MB",
    category: "embedding",
    isDownloaded: false,
    isDownloading: false,
  },
  {
    id: "mxbai-embed-large:latest",
    name: "MxBai Embed Large",
    description: "Large embedding model for better accuracy",
    size: "670MB",
    category: "embedding",
    isDownloaded: false,
    isDownloading: false,
  },
];

interface OllamaModel {
  id: string;
  name: string;
  description: string;
  size?: string;
  isDownloaded?: boolean;
  isDownloading?: boolean;
  downloadProgress?: number;
  downloadSpeed?: string;
  downloadETA?: string;
  category?: "main" | "embedding";
}

interface OllamaSettingsProps {
  ollamaModel: string;
  setOllamaModel: (value: string) => void;
  ollamaEmbeddingModel: string;
  setOllamaEmbeddingModel: (value: string) => void;
  ollamaEnabled: boolean;
  setOllamaEnabled: (value: boolean) => void;
  storagePath?: string;
  setStoragePath?: (path: string) => void;
}

export const OllamaSettings: React.FC<OllamaSettingsProps> = ({
  ollamaModel,
  setOllamaModel,
  ollamaEmbeddingModel,
  setOllamaEmbeddingModel,
  ollamaEnabled,
  setOllamaEnabled,
  storagePath = "./orch-os-memory",
  setStoragePath,
}) => {
  const [availableModels, setAvailableModels] =
    useState<OllamaModel[]>(AVAILABLE_MODELS);
  const [installedModels, setInstalledModels] = useState<string[]>([]);
  const [isLoadingModels, setIsLoadingModels] = useState(false);
  const [isLoadingAvailable, setIsLoadingAvailable] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [downloadingModels, setDownloadingModels] = useState<
    Map<string, { progress: number; speed: string; eta: string }>
  >(new Map());

  // Dropdown open/close state
  const [mainDropdownOpen, setMainDropdownOpen] = useState(false);
  const [embeddingDropdownOpen, setEmbeddingDropdownOpen] = useState(false);

  /* ------------------------------------------------------------------
   * Estado de carregamento dos modelos (vLLM) & polling
   * ------------------------------------------------------------------ */
  const [modelStatus, setModelStatus] = useState<VllmStatus | null>(null);

  useEffect(() => {
    let interval: NodeJS.Timeout;
    const fetchStatus = async () => {
      try {
        if (window.electronAPI?.vllmModelStatus) {
          const res = await window.electronAPI.vllmModelStatus();
          if (res?.success && res.status) {
            setModelStatus(res.status as VllmStatus);
          }
        }
      } catch {
        /* sil√™ncio */
      }
    };
    fetchStatus();
    interval = setInterval(fetchStatus, 2000);
    return () => clearInterval(interval);
  }, []);

  // Fun√ß√£o para buscar modelos instalados
  const fetchInstalledModels = useCallback(async () => {
    try {
      setIsLoadingModels(true);
      setError(null);

      // Tentar usar a API do Electron (Ollama) primeiro
      if (window.electronAPI?.listModels) {
        const models = await window.electronAPI.listModels();
        if (models && Array.isArray(models)) {
          const installed = models.map((m) => m.name || m.id);
          setInstalledModels(installed);
          return;
        }
      }

      // Fallback para API HTTP local do Ollama
      const response = await fetch("http://localhost:11434/api/tags");
      if (response.ok) {
        const data = await response.json();
        if (data.models && Array.isArray(data.models)) {
          setInstalledModels(data.models.map((m: any) => m.name));
        }
      } else {
        throw new Error("Ollama n√£o est√° rodando ou n√£o est√° acess√≠vel");
      }
    } catch (error) {
      console.error("Erro ao carregar modelos instalados:", error);
      setError(
        "N√£o foi poss√≠vel conectar ao Ollama. Verifique se est√° rodando."
      );
      setInstalledModels([]);
    } finally {
      setIsLoadingModels(false);
    }
  }, []);

  // Fun√ß√£o para buscar modelos dispon√≠veis (agora usa lista est√°tica)
  const fetchAvailableModels = useCallback(async () => {
    try {
      setIsLoadingAvailable(true);
      setError(null);

      // Usar lista est√°tica de modelos
      setAvailableModels(AVAILABLE_MODELS);
    } catch (error) {
      console.error("Erro ao carregar modelos dispon√≠veis:", error);
      setError("Erro ao carregar lista de modelos dispon√≠veis");
    } finally {
      setIsLoadingAvailable(false);
    }
  }, []);

  // Atualizar status dos modelos com base nos instalados
  useEffect(() => {
    const updatedModels = availableModels.map((model) => {
      const downloadInfo = downloadingModels.get(model.id);
      return {
        ...model,
        isDownloaded: installedModels.includes(model.id),
        isDownloading: downloadingModels.has(model.id),
        downloadProgress: downloadInfo?.progress || 0,
        downloadSpeed: downloadInfo?.speed || "",
        downloadETA: downloadInfo?.eta || "",
      };
    });
    setAvailableModels(updatedModels);
  }, [installedModels, downloadingModels]);

  // Carregar dados ao montar o componente
  useEffect(() => {
    const loadData = async () => {
      await Promise.all([fetchInstalledModels(), fetchAvailableModels()]);
    };

    loadData();
  }, [fetchInstalledModels, fetchAvailableModels]);

  // Fun√ß√£o para baixar modelo com progress via Ollama
  const downloadModel = async (modelId: string) => {
    try {
      // Iniciar download
      setDownloadingModels((prev) =>
        new Map(prev).set(modelId, {
          progress: 0,
          speed: "0 MB/s",
          eta: "Calculando...",
        })
      );

      // Tentar usar a API do Electron (Ollama) primeiro
      if (window.electronAPI?.downloadModel) {
        const success = await window.electronAPI.downloadModel(modelId);
        if (success) {
          // Recarregar lista ao concluir
          await fetchInstalledModels();
          setDownloadingModels((prev) => {
            const newMap = new Map(prev);
            newMap.delete(modelId);
            return newMap;
          });
          return;
        }
      }

      // Fallback para API HTTP do Ollama com simula√ß√£o de progresso
      const response = await fetch("http://localhost:11434/api/pull", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          name: modelId,
          stream: false,
        }),
      });

      if (response.ok) {
        // Simular progresso enquanto baixa
        const progressInterval = setInterval(() => {
          setDownloadingModels((prev) => {
            const current = prev.get(modelId);
            if (!current) return prev;

            const newProgress = Math.min(
              current.progress + Math.random() * 10,
              100
            );
            const newMap = new Map(prev);

            if (newProgress >= 100) {
              clearInterval(progressInterval);
              newMap.delete(modelId);
              // Adicionar √† lista de instalados
              setInstalledModels((prev) => [...prev, modelId]);
            } else {
              newMap.set(modelId, {
                progress: newProgress,
                speed: `${(Math.random() * 10 + 1).toFixed(1)} MB/s`,
                eta: `${Math.ceil((100 - newProgress) / 10)} min`,
              });
            }

            return newMap;
          });
        }, 1000);
      } else {
        throw new Error("Falha ao baixar modelo");
      }
    } catch (error) {
      console.error("Erro ao baixar modelo:", error);
      setDownloadingModels((prev) => {
        const newMap = new Map(prev);
        newMap.delete(modelId);
        return newMap;
      });
      setError(`Erro ao baixar modelo ${modelId}`);
    }
  };

  // Fun√ß√£o para cancelar download
  const cancelDownload = async (modelId: string) => {
    setDownloadingModels((prev) => {
      const newMap = new Map(prev);
      newMap.delete(modelId);
      return newMap;
    });
  };

  // Fun√ß√£o para remover modelo
  const removeModel = async (modelId: string) => {
    try {
      // Tentar usar a API do Electron (Ollama) primeiro
      if (window.electronAPI?.removeModel) {
        await window.electronAPI.removeModel(modelId);
        await fetchInstalledModels();
        return;
      }

      // Fallback para API HTTP do Ollama
      const response = await fetch("http://localhost:11434/api/delete", {
        method: "DELETE",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          name: modelId,
        }),
      });

      if (response.ok) {
        await fetchInstalledModels();
      } else {
        throw new Error("Falha ao remover modelo");
      }
    } catch (error) {
      console.error("Erro ao remover modelo:", error);
      setError(`Erro ao remover modelo ${modelId}`);
    }
  };

  // Fun√ß√£o para recarregar dados
  const refreshData = async () => {
    await Promise.all([fetchInstalledModels(), fetchAvailableModels()]);
  };

  // Fun√ß√£o para abrir seletor de diret√≥rio
  const handleBrowseStoragePath = async () => {
    try {
      if (window.electronAPI?.selectDirectory) {
        const result = await window.electronAPI.selectDirectory();
        if (result && result.success && result.path && setStoragePath) {
          setStoragePath(result.path);
        }
      } else {
        // Fallback para web - usar input file com webkitdirectory
        const input = document.createElement("input");
        input.type = "file";
        input.webkitdirectory = true;
        input.onchange = (e) => {
          const files = (e.target as HTMLInputElement).files;
          if (files && files.length > 0 && setStoragePath) {
            // Pegar o caminho do primeiro arquivo e extrair o diret√≥rio
            const firstFile = files[0];
            const pathParts = firstFile.webkitRelativePath.split("/");
            pathParts.pop(); // Remove o nome do arquivo
            const dirPath = pathParts.join("/");
            setStoragePath(dirPath || "./orch-os-memory");
          }
        };
        input.click();
      }
    } catch (error) {
      console.error("Erro ao selecionar diret√≥rio:", error);
    }
  };

  // Fun√ß√£o para obter o nome do modelo selecionado
  const getModelDisplayName = (modelId: string, modelsList: OllamaModel[]) => {
    const model = modelsList.find((m) => m.id === modelId);
    return model
      ? `${model.name} (${model.size})`
      : modelId || "Selecione um modelo...";
  };

  // Computed lists for dropdowns
  const mainModelsList = availableModels.filter(
    (m) => m.category !== "embedding"
  );
  const embeddingModelsList = availableModels.filter(
    (m) => m.category === "embedding"
  );

  // Computed lists for the interface
  const downloadedMainModels = mainModelsList.filter((m) => m.isDownloaded);
  const downloadedEmbeddingModels = embeddingModelsList.filter(
    (m) => m.isDownloaded
  );
  const downloadedModels = availableModels.filter((m) => m.isDownloaded);
  const availableForDownload = availableModels.filter((m) => !m.isDownloaded);

  // Indicadores de loading para os spinners
  const mainModelLoading = !!(
    modelStatus &&
    modelStatus.modelId === ollamaModel &&
    modelStatus.state !== "ready" &&
    modelStatus.state !== "idle" &&
    modelStatus.state !== "error"
  );

  const embeddingModelLoading = !!(
    modelStatus &&
    modelStatus.modelId === ollamaEmbeddingModel &&
    modelStatus.state !== "ready" &&
    modelStatus.state !== "idle" &&
    modelStatus.state !== "error"
  );

  // Fun√ß√£o para selecionar modelo principal
  const handleSelectMain = async (model: OllamaModel) => {
    setOllamaModel(model.id);
    if (!ollamaEnabled) setOllamaEnabled(true);
    setMainDropdownOpen(false);
    if (!model.isDownloaded && !model.isDownloading) {
      await downloadModel(model.id);
    }
  };

  // Fun√ß√£o para selecionar modelo de embedding
  const handleSelectEmbedding = async (model: OllamaModel) => {
    setOllamaEmbeddingModel(model.id);
    setEmbeddingDropdownOpen(false);
    if (!model.isDownloaded && !model.isDownloading) {
      await downloadModel(model.id);
    }
  };

  return (
    <div className="space-y-3">
      {/* Compact Header */}
      <div className="flex items-center justify-between">
        <div className="flex items-center space-x-2">
          <span className="text-sm">ü¶ô</span>
          <h3 className="text-sm font-medium text-cyan-300">Ollama Models</h3>
        </div>
        <button
          onClick={refreshData}
          disabled={isLoadingModels || isLoadingAvailable}
          className="bg-cyan-600/30 hover:bg-cyan-500/40 text-cyan-300 rounded px-2 py-1 transition-colors disabled:opacity-50 text-xs"
          title="Refresh models"
        >
          <span
            className={`${
              isLoadingModels || isLoadingAvailable ? "animate-spin" : ""
            }`}
          >
            üîÑ
          </span>
        </button>
      </div>

      {/* Error Message */}
      {error && (
        <div className="bg-red-500/10 border border-red-500/30 rounded p-2">
          <div className="flex items-center">
            <ExclamationTriangleIcon className="w-3 h-3 text-red-400 mr-1" />
            <div>
              <h4 className="text-red-400 font-medium text-[10px]">Erro</h4>
              <p className="text-red-400/70 text-[10px]">{error}</p>
            </div>
          </div>
        </div>
      )}

      {/* Storage Path - Inline */}
      <div className="flex items-center space-x-2">
        <span className="text-xs text-purple-400">üß† Storage:</span>
        <input
          type="text"
          value={storagePath}
          onChange={(e) => setStoragePath?.(e.target.value)}
          className="flex-1 bg-black/30 text-purple-300 rounded px-2 py-1 text-xs border border-purple-500/20 focus:outline-none focus:border-purple-400/50"
          placeholder="Storage path..."
        />
        <button
          onClick={handleBrowseStoragePath}
          className="bg-blue-600/30 hover:bg-blue-500/40 text-blue-300 rounded px-2 py-1 text-xs transition-colors"
        >
          üìÅ
        </button>
      </div>

      {/* Model Selection - Horizontal Layout */}
      <div className="grid grid-cols-2 gap-2">
        {/* Main Model */}
        <div className="relative">
          <label className="block text-xs text-cyan-400 mb-1">Main Model</label>
          <button
            onClick={() => setMainDropdownOpen((prev) => !prev)}
            disabled={isLoadingAvailable}
            className="flex items-center justify-between w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30 focus:outline-none hover:bg-black/50 transition-colors text-xs"
          >
            <span className="text-left truncate">
              {ollamaModel ? ollamaModel.split(":")[0] : "Select..."}
            </span>
            <ChevronDownIcon
              className={`w-3 h-3 transition-transform ${
                mainDropdownOpen ? "rotate-180" : ""
              }`}
            />
          </button>

          {mainDropdownOpen && (
            <div className="absolute z-10 w-full mt-1 bg-black/90 border border-cyan-500/30 rounded shadow-lg max-h-40 overflow-y-auto">
              {mainModelsList.map((model) => (
                <button
                  key={model.id}
                  onClick={() => handleSelectMain(model)}
                  className="w-full px-2 py-2 text-left hover:bg-cyan-500/20 transition-colors border-b border-cyan-500/10 last:border-b-0"
                >
                  <div className="flex items-center justify-between">
                    <div className="flex-1 truncate">
                      <div className="text-white/90 font-medium text-xs truncate">
                        {model.name}
                      </div>
                      <div className="text-cyan-400/60 text-[10px]">
                        {model.size}
                      </div>
                    </div>
                    {model.isDownloaded && (
                      <CheckCircleIcon className="w-3 h-3 text-green-400 ml-2" />
                    )}
                  </div>
                </button>
              ))}
            </div>
          )}
        </div>

        {/* Embedding Model */}
        <div className="relative">
          <label className="block text-xs text-cyan-400 mb-1">
            Embedding Model
          </label>
          <button
            onClick={() => setEmbeddingDropdownOpen((prev) => !prev)}
            disabled={isLoadingAvailable}
            className="flex items-center justify-between w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30 focus:outline-none hover:bg-black/50 transition-colors text-xs"
          >
            <span className="text-left truncate">
              {ollamaEmbeddingModel
                ? ollamaEmbeddingModel.split(":")[0]
                : "Select..."}
            </span>
            <ChevronDownIcon
              className={`w-3 h-3 transition-transform ${
                embeddingDropdownOpen ? "rotate-180" : ""
              }`}
            />
          </button>

          {embeddingDropdownOpen && (
            <div className="absolute z-10 w-full mt-1 bg-black/90 border border-cyan-500/30 rounded shadow-lg max-h-40 overflow-y-auto">
              {embeddingModelsList.map((model) => (
                <button
                  key={model.id}
                  onClick={() => handleSelectEmbedding(model)}
                  className="w-full px-2 py-2 text-left hover:bg-cyan-500/20 transition-colors border-b border-cyan-500/10 last:border-b-0"
                >
                  <div className="flex items-center justify-between">
                    <div className="flex-1 truncate">
                      <div className="text-white/90 font-medium text-xs truncate">
                        {model.name}
                      </div>
                      <div className="text-cyan-400/60 text-[10px]">
                        {model.size}
                      </div>
                    </div>
                    {model.isDownloaded && (
                      <CheckCircleIcon className="w-3 h-3 text-green-400 ml-2" />
                    )}
                  </div>
                </button>
              ))}
            </div>
          )}
        </div>
      </div>

      {/* Downloaded Models - Compact List */}
      {downloadedModels.length > 0 && (
        <div>
          <h4 className="text-xs font-medium text-green-400 mb-1">
            ‚úÖ Downloaded ({downloadedModels.length})
          </h4>
          <div className="space-y-1 max-h-32 overflow-y-auto">
            {downloadedModels.map((model) => (
              <div
                key={model.id}
                className="flex items-center justify-between bg-green-500/10 border border-green-500/30 rounded p-2"
              >
                <div className="flex items-center space-x-2 flex-1 truncate">
                  <CheckCircleIcon className="w-3 h-3 text-green-400" />
                  <span className="text-green-300 text-xs truncate">
                    {model.name}
                  </span>
                  <span className="text-green-400/60 text-[10px]">
                    {model.size}
                  </span>
                  {model.category === "embedding" && (
                    <span className="px-1 py-0.5 bg-blue-500/20 text-blue-300 text-[9px] rounded">
                      Embed
                    </span>
                  )}
                </div>
                <button
                  onClick={() => removeModel(model.id)}
                  className="bg-red-600/20 hover:bg-red-500/30 text-red-400 rounded p-1 transition-colors"
                  title="Remove Model"
                >
                  <TrashIcon className="w-3 h-3" />
                </button>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* Available Models - Compact List */}
      {availableForDownload.length > 0 && (
        <div>
          <h4 className="text-xs font-medium text-cyan-400 mb-1">
            üì• Available ({availableForDownload.length})
          </h4>
          <div className="space-y-1 max-h-32 overflow-y-auto">
            {availableForDownload.map((model) => (
              <div
                key={model.id}
                className="bg-black/30 border border-cyan-500/20 rounded p-2"
              >
                <div className="flex items-center justify-between">
                  <div className="flex items-center space-x-2 flex-1 truncate">
                    <span className="text-cyan-300 text-xs truncate">
                      {model.name}
                    </span>
                    <span className="text-cyan-400/60 text-[10px]">
                      {model.size}
                    </span>
                    {model.category === "embedding" && (
                      <span className="px-1 py-0.5 bg-blue-500/20 text-blue-300 text-[9px] rounded">
                        Embed
                      </span>
                    )}
                  </div>
                  <div className="flex items-center space-x-1">
                    {model.isDownloading ? (
                      <button
                        onClick={() => cancelDownload(model.id)}
                        className="bg-red-600/30 hover:bg-red-500/40 text-red-300 rounded p-1 transition-colors"
                        title="Cancel Download"
                      >
                        <XMarkIcon className="w-3 h-3" />
                      </button>
                    ) : (
                      <button
                        onClick={() => downloadModel(model.id)}
                        className="bg-cyan-600/30 hover:bg-cyan-500/40 text-cyan-300 rounded p-1 transition-colors"
                        title="Download Model"
                      >
                        <ArrowDownTrayIcon className="w-3 h-3" />
                      </button>
                    )}
                  </div>
                </div>

                {model.isDownloading && (
                  <div className="mt-2 space-y-1">
                    <div className="flex justify-between text-[10px]">
                      <span className="text-yellow-400">Downloading...</span>
                      <span className="text-yellow-300">
                        {model.downloadProgress?.toFixed(1)}%
                      </span>
                    </div>
                    <div className="w-full bg-gray-700 rounded-full h-1">
                      <div
                        className="bg-gradient-to-r from-yellow-400 to-orange-400 h-1 rounded-full transition-all duration-300"
                        style={{ width: `${model.downloadProgress || 0}%` }}
                      ></div>
                    </div>
                    <div className="flex justify-between text-[9px] text-yellow-400/70">
                      <span>{model.downloadSpeed}</span>
                      <span>ETA: {model.downloadETA}</span>
                    </div>
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
};

export default OllamaSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import { PineconeSettingsProps } from './types';
import { setOption, STORAGE_KEYS } from '../../../../../../services/StorageService';

/**
 * Componente para configura√ß√£o da integra√ß√£o com Pinecone Vector Database
 * Implementa princ√≠pio de Responsabilidade √önica (SRP) do SOLID
 */
export const PineconeSettings: React.FC<PineconeSettingsProps> = ({
  pineconeApiKey,
  setPineconeApiKey
}) => {
  return (
    <div className="p-4 rounded-md bg-black/20 mb-4 animate-fade-in">
      <h3 className="text-lg text-cyan-300 mb-4">Pinecone Vector Database</h3>
      <div className="space-y-4">
        <div>
          <label htmlFor="pineconeApiKey" className="block mb-1 text-sm text-cyan-200/80">Pinecone API Key</label>
          <input 
            type="password"
            id="pineconeApiKey"
            className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
            value={pineconeApiKey}
            onChange={e => {
              setPineconeApiKey(e.target.value);
              setOption(STORAGE_KEYS.PINECONE_API_KEY, e.target.value);
            }}
            placeholder="Enter your Pinecone API key"
          />
          <p className="text-xs text-cyan-400/60 mt-1">Used for long-term memory storage.</p>
        </div>
      </div>
    </div>
  );
};

export default PineconeSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { OrchOSMode } from "../../../../../../services/ModeService";

/**
 * Tipos para os componentes de configura√ß√£o de APIs
 * Seguindo princ√≠pio de Interface Segregation do SOLID
 * Interface unificada sem navega√ß√£o por abas
 */

// Props base para todos componentes de API settings
export interface BaseApiSettingsProps {
  applicationMode: OrchOSMode;
}

// Props espec√≠ficas para Ollama
export interface OllamaSettingsProps {
  ollamaModel: string;
  setOllamaModel: (value: string) => void;
  ollamaEmbeddingModel: string;
  setOllamaEmbeddingModel: (value: string) => void;
  ollamaEnabled: boolean;
  setOllamaEnabled: (value: boolean) => void;
  storagePath?: string;
  setStoragePath?: (path: string) => void;
}

// Props completas para o componente ApiSettings (interface unificada)
export interface ApiSettingsProps {
  applicationMode: OrchOSMode;
  setApplicationMode: (mode: OrchOSMode) => void;
  // Ollama
  ollamaModel: string;
  setOllamaModel: (value: string) => void;
  ollamaEmbeddingModel: string;
  setOllamaEmbeddingModel: (value: string) => void;
  ollamaEnabled: boolean;
  setOllamaEnabled: (value: boolean) => void;
}

// Tipos legados mantidos para compatibilidade (podem ser removidos gradualmente)
export interface PineconeSettingsProps {
  pineconeApiKey: string;
  setPineconeApiKey: (value: string) => void;
}

export interface ChatGPTSettingsProps extends BaseApiSettingsProps {
  chatgptApiKey: string;
  setChatgptApiKey: (value: string) => void;
  chatgptModel: string;
  setChatgptModel: (value: string) => void;
  openaiEmbeddingModel: string;
  setOpenaiEmbeddingModel: (value: string) => void;
}

export interface HuggingFaceSettingsProps extends BaseApiSettingsProps {
  hfModel: string;
  setHfModel: (value: string) => void;
  hfEmbeddingModel: string;
  setHfEmbeddingModel: (value: string) => void;
  hfModelOptions?: Array<{ id: string; label: string }>;
  hfEmbeddingModelOptions?: Array<{ id: string; label: string }>;
  setApplicationMode?: (mode: OrchOSMode) => void;
}

export interface DeepgramSettingsProps {
  deepgramApiKey: string;
  setDeepgramApiKey: (value: string) => void;
  deepgramModel: string;
  setDeepgramModel: (value: string) => void;
  deepgramLanguage: string;
  setDeepgramLanguage: (value: string) => void;
}
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { useEffect, useMemo, useState } from "react";
import {
  getOption,
  setOption,
  STORAGE_KEYS,
  subscribeToStorageChanges,
} from "../../../../../../services/StorageService";

/**
 * Hook para gerenciamento de configura√ß√µes de APIs externas
 * Interface unificada sem navega√ß√£o por abas
 * Neur√¥nio de infraestrutura respons√°vel pelas credenciais e par√¢metros de servi√ßos
 */
export const useApiSettings = () => {
  // Ollama - configura√ß√µes principais
  const [ollamaModel, setOllamaModel] = useState<string>(
    () => getOption<string>(STORAGE_KEYS.OLLAMA_MODEL) || ""
  );
  const [ollamaEmbeddingModel, setOllamaEmbeddingModel] = useState<string>(
    () => getOption<string>(STORAGE_KEYS.OLLAMA_EMBEDDING_MODEL) || ""
  );
  const [ollamaEnabled, setOllamaEnabled] = useState<boolean>(
    () => getOption<boolean>(STORAGE_KEYS.OLLAMA_ENABLED) || false
  );

  // Sincroniza mudan√ßas do storage para o estado local
  useEffect(() => {
    const handleStorageChange = (key: string, value: any) => {
      switch (key) {
        // Ollama
        case STORAGE_KEYS.OLLAMA_MODEL:
          if (value !== ollamaModel) setOllamaModel(value);
          break;
        case STORAGE_KEYS.OLLAMA_EMBEDDING_MODEL:
          if (value !== ollamaEmbeddingModel) setOllamaEmbeddingModel(value);
          break;
        case STORAGE_KEYS.OLLAMA_ENABLED:
          if (value !== ollamaEnabled) setOllamaEnabled(value);
          break;
      }
    };

    const unsubscribe = subscribeToStorageChanges(handleStorageChange);
    return () => unsubscribe();
  }, [ollamaModel, ollamaEmbeddingModel, ollamaEnabled]);

  // Salva as configura√ß√µes de API no storage
  const saveApiSettings = () => {
    // Ollama
    setOption(STORAGE_KEYS.OLLAMA_MODEL, ollamaModel);
    setOption(STORAGE_KEYS.OLLAMA_EMBEDDING_MODEL, ollamaEmbeddingModel);
    setOption(STORAGE_KEYS.OLLAMA_ENABLED, ollamaEnabled);
  };

  // Memoize all API settings to ensure stable reference and avoid unnecessary renders
  return useMemo(
    () => ({
      // Ollama
      ollamaModel,
      setOllamaModel,
      ollamaEmbeddingModel,
      setOllamaEmbeddingModel,
      ollamaEnabled,
      setOllamaEnabled,
      // Salvar tudo
      saveApiSettings,
    }),
    [
      ollamaModel,
      setOllamaModel,
      ollamaEmbeddingModel,
      setOllamaEmbeddingModel,
      ollamaEnabled,
      setOllamaEnabled,
      saveApiSettings,
    ]
  );
};
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { useState, useEffect, useRef, useMemo } from "react";
import { getOption, setOption, STORAGE_KEYS, subscribeToStorageChanges } from '../../../../../../services/StorageService';

/**
 * Hook para gerenciamento de configura√ß√µes de √°udio
 * Cortex neural para processamento e qualidade do sinal de √°udio
 */
export const useAudioSettings = (show: boolean) => {
  // Estado neural-simb√≥lico para op√ß√µes de √°udio
  const [audioQuality, setAudioQuality] = useState<number>(() => getOption<number>(STORAGE_KEYS.AUDIO_QUALITY) ?? 80);
  const [autoGainControl, setAutoGainControl] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.AUTO_GAIN_CONTROL) ?? true);
  const [noiseSuppression, setNoiseSuppression] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.NOISE_SUPPRESSION) ?? true);
  const [echoCancellation, setEchoCancellation] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.ECHO_CANCELLATION) ?? true);
  const [enhancedPunctuation, setEnhancedPunctuation] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.ENHANCED_PUNCTUATION) ?? true);
  const [speakerDiarization, setSpeakerDiarization] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.SPEAKER_DIARIZATION) ?? true);
  
  // Transcri√ß√£o
  const [transcriptionEnabled, setTranscriptionEnabled] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.TRANSCRIPTION_ENABLED) ?? true);
  const [speakerIdentification, setSpeakerIdentification] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.SPEAKER_IDENTIFICATION) ?? true);
  
  // Sincroniza mudan√ßas do storage para o estado local
  useEffect(() => {
    const handleStorageChange = (key: string, value: any) => {
      switch(key) {
        case STORAGE_KEYS.AUDIO_QUALITY: setAudioQuality(value); break;
        case STORAGE_KEYS.AUTO_GAIN_CONTROL: setAutoGainControl(value); break;
        case STORAGE_KEYS.NOISE_SUPPRESSION: setNoiseSuppression(value); break;
        case STORAGE_KEYS.ECHO_CANCELLATION: setEchoCancellation(value); break;
        case STORAGE_KEYS.ENHANCED_PUNCTUATION: setEnhancedPunctuation(value); break;
        case STORAGE_KEYS.SPEAKER_DIARIZATION: setSpeakerDiarization(value); break;
        case STORAGE_KEYS.TRANSCRIPTION_ENABLED: setTranscriptionEnabled(value); break;
        case STORAGE_KEYS.SPEAKER_IDENTIFICATION: setSpeakerIdentification(value); break;
      }
    };
    
    const unsubscribe = subscribeToStorageChanges(handleStorageChange);
    return () => unsubscribe();
  }, []);
  
  // Salva as configura√ß√µes de √°udio no storage
  const saveAudioSettings = () => {
    setOption(STORAGE_KEYS.AUDIO_QUALITY, audioQuality);
    setOption(STORAGE_KEYS.AUTO_GAIN_CONTROL, autoGainControl);
    setOption(STORAGE_KEYS.NOISE_SUPPRESSION, noiseSuppression);
    setOption(STORAGE_KEYS.ECHO_CANCELLATION, echoCancellation);
    setOption(STORAGE_KEYS.ENHANCED_PUNCTUATION, enhancedPunctuation);
    setOption(STORAGE_KEYS.SPEAKER_DIARIZATION, speakerDiarization);
    setOption(STORAGE_KEYS.TRANSCRIPTION_ENABLED, transcriptionEnabled);
    setOption(STORAGE_KEYS.SPEAKER_IDENTIFICATION, speakerIdentification);
  };
  
  return useMemo(() => ({
    // Valores
    audioQuality,
    setAudioQuality,
    autoGainControl,
    setAutoGainControl,
    noiseSuppression,
    setNoiseSuppression,
    echoCancellation,
    setEchoCancellation,
    enhancedPunctuation,
    setEnhancedPunctuation,
    speakerDiarization,
    setSpeakerDiarization,
    transcriptionEnabled,
    setTranscriptionEnabled,
    speakerIdentification,
    setSpeakerIdentification,
    // A√ß√µes
    saveAudioSettings
  }), [
    audioQuality,
    setAudioQuality,
    autoGainControl,
    setAutoGainControl,
    noiseSuppression,
    setNoiseSuppression,
    echoCancellation,
    setEchoCancellation,
    enhancedPunctuation,
    setEnhancedPunctuation,
    speakerDiarization,
    setSpeakerDiarization,
    transcriptionEnabled,
    setTranscriptionEnabled,
    speakerIdentification,
    setSpeakerIdentification,
    saveAudioSettings
  ]);
};
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { useState, useEffect, useMemo } from "react";
import { getOption, setOption, STORAGE_KEYS, subscribeToStorageChanges } from '../../../../../../services/StorageService';

/**
 * Hook para gerenciamento de configura√ß√µes de depura√ß√£o
 * Neur√¥nio metacognitivo de diagn√≥stico e instrumenta√ß√£o
 */
export const useDebugSettings = () => {
  // Estado neural-simb√≥lico para op√ß√µes de debug
  const [debugMode, setDebugMode] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.DEBUG_MODE) ?? false);
  const [logLevel, setLogLevel] = useState<string>(() => getOption<string>(STORAGE_KEYS.LOG_LEVEL) || 'info');
  
  // Sincroniza mudan√ßas do storage para o estado local
  useEffect(() => {
    const handleStorageChange = (key: string, value: any) => {
      switch(key) {
        case STORAGE_KEYS.DEBUG_MODE: setDebugMode(value); break;
        case STORAGE_KEYS.LOG_LEVEL: setLogLevel(value); break;
      }
    };
    
    const unsubscribe = subscribeToStorageChanges(handleStorageChange);
    return () => unsubscribe();
  }, []);
  
  // Salva as configura√ß√µes de debug no storage
  const saveDebugSettings = () => {
    setOption(STORAGE_KEYS.DEBUG_MODE, debugMode);
    setOption(STORAGE_KEYS.LOG_LEVEL, logLevel);
  };
  
  return useMemo(() => ({
    // Valores
    debugMode,
    setDebugMode,
    logLevel,
    setLogLevel,
    // A√ß√µes
    saveDebugSettings
  }), [
    debugMode,
    setDebugMode,
    logLevel,
    setLogLevel,
    saveDebugSettings
  ]);
};
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { useState, useEffect, useMemo } from "react";
import { getOption, getUserName, setOption, STORAGE_KEYS, subscribeToStorageChanges } from '../../../../../../services/StorageService';
import { ModeService, OrchOSMode } from '../../../../../../services/ModeService';

/**
 * Hook para gerenciamento de configura√ß√µes gerais
 * Componente neural-simb√≥lico para configura√ß√µes b√°sicas do sistema
 */
export const useGeneralSettings = () => {
  // Estado neural-simb√≥lico para op√ß√µes gerais
  const [name, setName] = useState<string>(() => getUserName() || 'User');
  const [enableMatrix, setEnableMatrix] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.ENABLE_MATRIX) ?? true);
  const [matrixDensity, setMatrixDensity] = useState<number>(() => getOption<number>(STORAGE_KEYS.MATRIX_DENSITY) ?? 60);
  const [enableEffects, setEnableEffects] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.ENABLE_EFFECTS) ?? true);
  const [enableAnimations, setEnableAnimations] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.ENABLE_ANIMATIONS) ?? true);
  
  // Orch-OS Mode Cortex: single source of truth for mode
  const [applicationMode, setApplicationMode] = useState<OrchOSMode>(
    () => ModeService.getMode()
  );
  
  // Sincroniza mudan√ßas do storage para o estado local
  useEffect(() => {
    const handleStorageChange = (key: string, value: any) => {
      switch(key) {
        case STORAGE_KEYS.USER_NAME: setName(value); break;
        case STORAGE_KEYS.APPLICATION_MODE: 
          setApplicationMode(value);
          break;
        case STORAGE_KEYS.ENABLE_MATRIX: setEnableMatrix(value); break;
        case STORAGE_KEYS.MATRIX_DENSITY: setMatrixDensity(value); break;
        case STORAGE_KEYS.ENABLE_EFFECTS: setEnableEffects(value); break;
        case STORAGE_KEYS.ENABLE_ANIMATIONS: setEnableAnimations(value); break;
      }
    };
    
    const unsubscribe = subscribeToStorageChanges(handleStorageChange);
    return () => unsubscribe();
  }, []);
  
  // Salva as configura√ß√µes gerais no storage
  const saveGeneralSettings = () => {
    setOption(STORAGE_KEYS.USER_NAME, name);
    if (applicationMode) {
      setOption(STORAGE_KEYS.APPLICATION_MODE, applicationMode);
      ModeService.setMode(applicationMode); // Atualiza o modo no servi√ßo
    }
    setOption(STORAGE_KEYS.ENABLE_MATRIX, enableMatrix);
    setOption(STORAGE_KEYS.MATRIX_DENSITY, matrixDensity);
    setOption(STORAGE_KEYS.ENABLE_EFFECTS, enableEffects);
    setOption(STORAGE_KEYS.ENABLE_ANIMATIONS, enableAnimations);
  };
  
  return useMemo(() => ({
    // Valores
    name,
    setName,
    applicationMode,
    setApplicationMode,
    enableMatrix,
    setEnableMatrix,
    matrixDensity,
    setMatrixDensity,
    enableEffects,
    setEnableEffects,
    enableAnimations,
    setEnableAnimations,
    // A√ß√µes
    saveGeneralSettings
  }), [
    name,
    setName,
    applicationMode,
    setApplicationMode,
    enableMatrix,
    setEnableMatrix,
    matrixDensity,
    setMatrixDensity,
    enableEffects,
    setEnableEffects,
    enableAnimations,
    setEnableAnimations,
    saveGeneralSettings
  ]);
};
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { useState, useEffect, useMemo } from "react";
import { getOption, setOption, STORAGE_KEYS, subscribeToStorageChanges } from '../../../../../../services/StorageService';

/**
 * Hook para gerenciamento de configura√ß√µes de interface
 * Componente neural-simb√≥lico especializado na experi√™ncia visual do usu√°rio
 */
export const useInterfaceSettings = () => {
  // Estado neural-simb√≥lico para op√ß√µes de interface
  const [darkMode, setDarkMode] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.DARK_MODE) ?? true);
  const [enableNeumorphism, setEnableNeumorphism] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.ENABLE_NEUMORPHISM) ?? true);
  const [enableGlassmorphism, setEnableGlassmorphism] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.ENABLE_GLASSMORPHISM) ?? true);
  const [panelTransparency, setPanelTransparency] = useState<number>(() => getOption<number>(STORAGE_KEYS.PANEL_TRANSPARENCY) ?? 70);
  const [colorTheme, setColorTheme] = useState<string>(() => getOption<string>(STORAGE_KEYS.COLOR_THEME) || 'quantum-blue');
  const [theme, setTheme] = useState<string>(() => getOption<string>(STORAGE_KEYS.THEME) || 'auto');
  const [uiDensity, setUiDensity] = useState<string>(() => getOption<string>(STORAGE_KEYS.UI_DENSITY) || 'normal');
  const [showAdvancedSettings, setShowAdvancedSettings] = useState<boolean>(() => getOption<boolean>(STORAGE_KEYS.SHOW_ADVANCED_SETTINGS) ?? false);
  
  // Sincroniza mudan√ßas do storage para o estado local
  useEffect(() => {
    const handleStorageChange = (key: string, value: any) => {
      switch(key) {
        case STORAGE_KEYS.DARK_MODE: setDarkMode(value); break;
        case STORAGE_KEYS.ENABLE_NEUMORPHISM: setEnableNeumorphism(value); break;
        case STORAGE_KEYS.ENABLE_GLASSMORPHISM: setEnableGlassmorphism(value); break;
        case STORAGE_KEYS.PANEL_TRANSPARENCY: setPanelTransparency(value); break;
        case STORAGE_KEYS.COLOR_THEME: setColorTheme(value); break;
        case STORAGE_KEYS.THEME: setTheme(value); break;
        case STORAGE_KEYS.UI_DENSITY: setUiDensity(value); break;
        case STORAGE_KEYS.SHOW_ADVANCED_SETTINGS: setShowAdvancedSettings(value); break;
      }
    };
    
    const unsubscribe = subscribeToStorageChanges(handleStorageChange);
    return () => unsubscribe();
  }, []);
  
  // Salva as configura√ß√µes de interface no storage
  const saveInterfaceSettings = () => {
    setOption(STORAGE_KEYS.DARK_MODE, darkMode);
    setOption(STORAGE_KEYS.ENABLE_NEUMORPHISM, enableNeumorphism);
    setOption(STORAGE_KEYS.ENABLE_GLASSMORPHISM, enableGlassmorphism);
    setOption(STORAGE_KEYS.PANEL_TRANSPARENCY, panelTransparency);
    setOption(STORAGE_KEYS.COLOR_THEME, colorTheme);
    setOption(STORAGE_KEYS.THEME, theme);
    setOption(STORAGE_KEYS.UI_DENSITY, uiDensity);
    setOption(STORAGE_KEYS.SHOW_ADVANCED_SETTINGS, showAdvancedSettings);
  };
  
  return useMemo(() => ({
    // Valores
    darkMode,
    setDarkMode,
    enableNeumorphism,
    setEnableNeumorphism,
    enableGlassmorphism,
    setEnableGlassmorphism,
    panelTransparency,
    setPanelTransparency,
    colorTheme,
    setColorTheme,
    theme,
    setTheme,
    uiDensity,
    setUiDensity,
    showAdvancedSettings,
    setShowAdvancedSettings,
    
    // A√ß√µes
    saveInterfaceSettings
  }), [
    darkMode,
    setDarkMode,
    enableNeumorphism,
    setEnableNeumorphism,
    enableGlassmorphism,
    setEnableGlassmorphism,
    panelTransparency,
    setPanelTransparency,
    colorTheme,
    setColorTheme,
    theme,
    setTheme,
    uiDensity,
    setUiDensity,
    showAdvancedSettings,
    setShowAdvancedSettings,
    saveInterfaceSettings
  ]);
};
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { useState, useMemo } from "react";
import { OpenSectionType, TabType } from '../types';

/**
 * Hook para gerenciamento de estado de navega√ß√£o do modal de configura√ß√µes
 * Implementa o princ√≠pio de responsabilidade √∫nica gerenciando apenas a navega√ß√£o
 */
export const useNavigationState = () => {
  const [openSection, setOpenSection] = useState<OpenSectionType>(null);
  const [activeTab, setActiveTab] = useState<TabType>('general');

  return useMemo(() => ({
    openSection,
    setOpenSection,
    activeTab,
    setActiveTab
  }), [
    openSection,
    setOpenSection,
    activeTab,
    setActiveTab
  ]);
};
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React, { memo, useState } from "react";
import { OrchOSModeEnum } from "../../../../../services/ModeService";
import {
  getOption,
  setOption,
  STORAGE_KEYS,
} from "../../../../../services/StorageService";

import { BasicModeSettings, OllamaSettings } from "./api";
import { ApiSettingsProps } from "./api/types";

/**
 * Componente orquestrador para configura√ß√µes de APIs externas
 * Arquitetura de modos:
 * - Modo Basic: HuggingFace (modelos leves via Transformers.js)
 * - Modo Advanced: Ollama + configura√ß√µes avan√ßadas (interface unificada)
 *
 * Refatorado seguindo princ√≠pios SOLID:
 * - Single Responsibility Principle: cada subcomponente tem responsabilidade √∫nica
 * - Open/Closed Principle: aberto para extens√£o, fechado para modifica√ß√£o
 * - Liskov Substitution: interfaces consistentes entre componentes
 * - Interface Segregation: interfaces espec√≠ficas para cada tipo de configura√ß√£o
 * - Dependency Inversion: depende de abstra√ß√µes, n√£o implementa√ß√µes concretas
 */
const ApiSettings: React.FC<ApiSettingsProps> = memo(
  ({
    applicationMode,
    setApplicationMode,
    ollamaModel,
    setOllamaModel,
    ollamaEmbeddingModel,
    setOllamaEmbeddingModel,
    ollamaEnabled,
    setOllamaEnabled,
  }) => {
    // Estado para configura√ß√µes avan√ßadas
    const [duckDbPath, setDuckDbPath] = useState<string>(
      () => getOption<string>(STORAGE_KEYS.DUCKDB_PATH) || "./orch-os-memory"
    );

    const [toolsEnabled, setToolsEnabled] = useState<boolean>(
      () => getOption<boolean>(STORAGE_KEYS.TOOLS_ENABLED) ?? true
    );

    // AI model options for HuggingFace (modo b√°sico)
    const HF_MODELS = [
      {
        id: "Xenova/llama2.c-stories15M",
        label: "Llama2.c Stories (~15MB) - Ultra pequeno",
      },
      {
        id: "Xenova/distilgpt2",
        label: "DistilGPT-2 (~353MB) - Otimizado",
      },
      {
        id: "Xenova/gpt2",
        label: "GPT-2 Base (~548MB) - Est√°vel",
      },
      {
        id: "Xenova/TinyLlama-1.1B-Chat-v1.0",
        label: "TinyLlama Chat (~1.1B) - Modelo de chat",
      },
    ];

    // Lista de modelos de embedding compat√≠veis (modo b√°sico)
    const HF_EMBEDDING_MODELS = [
      {
        id: "Xenova/all-MiniLM-L6-v2",
        label: "all-MiniLM-L6-v2 (MiniLM 384d) ‚Äî Recomendado",
      },
    ];

    // Handler para sele√ß√£o de diret√≥rio DuckDB
    const handleBrowseDirectory = async () => {
      try {
        if (typeof window !== "undefined" && (window as any).electronAPI) {
          const result = await (window as any).electronAPI.selectDirectory();

          if (result.success && result.path) {
            const newPath = result.path;
            setDuckDbPath(newPath);
            setOption(STORAGE_KEYS.DUCKDB_PATH, newPath);
            console.log("üìÅ [SETTINGS] DuckDB path updated:", newPath);

            // Reinicializar DuckDB com o novo caminho
            try {
              const reinitResult = await (
                window as any
              ).electronAPI.reinitializeDuckDB(newPath);
              if (reinitResult.success) {
                console.log(
                  "‚úÖ [SETTINGS] DuckDB successfully reinitialized with new path"
                );
              } else {
                console.error(
                  "‚ùå [SETTINGS] Failed to reinitialize DuckDB:",
                  reinitResult.error
                );
              }
            } catch (reinitError) {
              console.error(
                "‚ùå [SETTINGS] Error reinitializing DuckDB:",
                reinitError
              );
            }
          } else if (!result.canceled) {
            console.error(
              "‚ùå [SETTINGS] Failed to select directory:",
              result.error
            );
          }
        } else {
          console.warn(
            "‚ö†Ô∏è [SETTINGS] Directory selection not available in web mode"
          );
        }
      } catch (error) {
        console.error("‚ùå [SETTINGS] Error selecting directory:", error);
      }
    };

    // Handler para mudan√ßa manual do caminho DuckDB
    const handlePathChange = async (newPath: string) => {
      setDuckDbPath(newPath);
      setOption(STORAGE_KEYS.DUCKDB_PATH, newPath);

      // Reinicializar DuckDB apenas se estamos no Electron e o caminho n√£o est√° vazio
      if (
        typeof window !== "undefined" &&
        (window as any).electronAPI &&
        newPath.trim()
      ) {
        try {
          const reinitResult = await (
            window as any
          ).electronAPI.reinitializeDuckDB(newPath);
          if (reinitResult.success) {
            console.log(
              "‚úÖ [SETTINGS] DuckDB successfully reinitialized with new path"
            );
          } else {
            console.error(
              "‚ùå [SETTINGS] Failed to reinitialize DuckDB:",
              reinitResult.error
            );
          }
        } catch (reinitError) {
          console.error(
            "‚ùå [SETTINGS] Error reinitializing DuckDB:",
            reinitError
          );
        }
      }
    };

    // Handler para atualiza√ß√£o do modelo HuggingFace (modo b√°sico)
    const handleHfModelChange = (value: string) => {
      setOption(STORAGE_KEYS.HF_MODEL, value);
    };

    // Handler para atualiza√ß√£o do modelo de embedding HuggingFace (modo b√°sico)
    const handleHfEmbeddingModelChange = (value: string) => {
      setOption(STORAGE_KEYS.HF_EMBEDDING_MODEL, value);
    };

    // Renderiza√ß√£o condicional baseada no modo da aplica√ß√£o
    if (applicationMode === OrchOSModeEnum.BASIC) {
      return (
        <div className="space-y-4">
          {/* Header explicativo para modo b√°sico */}
          <div className="bg-gradient-to-r from-green-500/10 to-blue-500/10 border border-green-500/30 rounded-lg p-4">
            <div className="flex items-center space-x-3">
              <div className="w-8 h-8 flex items-center justify-center rounded-full bg-green-500/20">
                <span className="text-green-400 text-sm">ü§ó</span>
              </div>
              <div>
                <h3 className="text-green-400 font-medium">
                  Modo Basic - HuggingFace
                </h3>
                <p className="text-green-400/70 text-sm">
                  Modelos leves executados via Transformers.js no navegador
                </p>
              </div>
            </div>
          </div>

          <BasicModeSettings
            applicationMode={applicationMode}
            setApplicationMode={setApplicationMode}
            hfModel=""
            setHfModel={handleHfModelChange}
            hfEmbeddingModel=""
            setHfEmbeddingModel={handleHfEmbeddingModelChange}
            hfModelOptions={HF_MODELS}
            hfEmbeddingModelOptions={HF_EMBEDDING_MODELS}
          />
        </div>
      );
    }

    return (
      <div className="flex flex-col w-full space-y-6">
        {/* Header explicativo para modo avan√ßado */}
        <div className="bg-gradient-to-r from-cyan-500/10 to-purple-500/10 border border-cyan-500/30 rounded-lg p-4">
          <div className="flex items-center space-x-3">
            <div className="w-8 h-8 flex items-center justify-center rounded-full bg-cyan-500/20">
              <span className="text-cyan-400 text-sm">ü¶ô</span>
            </div>
            <div>
              <h3 className="text-cyan-400 font-medium">
                Modo Advanced - Configura√ß√µes Completas
              </h3>
              <p className="text-cyan-400/70 text-sm">
                Ollama, banco de dados e configura√ß√µes avan√ßadas
              </p>
            </div>
          </div>
        </div>

        {/* Se√ß√£o Ollama - Modelos Locais */}
        <OllamaSettings
          ollamaModel={ollamaModel}
          setOllamaModel={(value) => {
            setOllamaModel(value);
            setOption(STORAGE_KEYS.OLLAMA_MODEL, value);
          }}
          ollamaEmbeddingModel={ollamaEmbeddingModel}
          setOllamaEmbeddingModel={(value) => {
            setOllamaEmbeddingModel(value);
            setOption(STORAGE_KEYS.OLLAMA_EMBEDDING_MODEL, value);
          }}
          ollamaEnabled={ollamaEnabled}
          setOllamaEnabled={(value) => {
            setOllamaEnabled(value);
            setOption(STORAGE_KEYS.OLLAMA_ENABLED, value);
          }}
          storagePath={duckDbPath}
          setStoragePath={(path) => {
            handlePathChange(path);
          }}
        />

        {/* Bot√£o para voltar ao modo b√°sico */}
        <div className="flex justify-end">
          <button
            type="button"
            className="bg-gradient-to-r from-green-500/20 to-blue-500/20 text-green-300 border border-green-500/30 rounded-lg px-6 py-2 hover:from-green-500/30 hover:to-blue-500/30 transition-all shadow-[0_0_10px_rgba(0,255,100,0.2)] backdrop-blur-sm"
            onClick={() => setApplicationMode(OrchOSModeEnum.BASIC)}
          >
            ü§ó Switch to Basic Mode (HuggingFace)
          </button>
        </div>
      </div>
    );
  }
);

export default ApiSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';

/**
 * Componente para configura√ß√µes de √°udio e transcri√ß√£o
 * Respons√°vel por configura√ß√µes relacionadas a entrada de √°udio e processamento
 */
interface AudioSettingsProps {
  enhancedPunctuation: boolean;
  setEnhancedPunctuation: (value: boolean) => void;
  speakerDiarization: boolean;
  setSpeakerDiarization: (value: boolean) => void;
  audioQuality: number;
  setAudioQuality: (value: number) => void;
  autoGainControl: boolean;
  setAutoGainControl: (value: boolean) => void;
  noiseSuppression: boolean;
  setNoiseSuppression: (value: boolean) => void;
  echoCancellation: boolean;
  setEchoCancellation: (value: boolean) => void;
}

const AudioSettings: React.FC<AudioSettingsProps> = ({
  enhancedPunctuation,
  setEnhancedPunctuation,
  speakerDiarization,
  setSpeakerDiarization,
  audioQuality,
  setAudioQuality,
  autoGainControl,
  setAutoGainControl,
  noiseSuppression,
  setNoiseSuppression,
  echoCancellation,
  setEchoCancellation
}) => {
  return (
    <div className="space-y-4">
      {/* Configura√ß√µes de transcri√ß√£o */}
      <div>
        <h3 className="text-cyan-300 mb-2">Transcription Options</h3>
        
        <div className="flex items-center mb-2">
          <input
            type="checkbox"
            id="enhancedPunctuation"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={enhancedPunctuation}
            onChange={e => setEnhancedPunctuation(e.target.checked)}
          />
          <label htmlFor="enhancedPunctuation" className="text-cyan-100/80">Enhanced Punctuation</label>
        </div>
        
        <div className="flex items-center mb-2">
          <input
            type="checkbox"
            id="speakerDiarization"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={speakerDiarization}
            onChange={e => setSpeakerDiarization(e.target.checked)}
          />
          <label htmlFor="speakerDiarization" className="text-cyan-100/80">Speaker Diarization</label>
        </div>
      </div>

      {/* Qualidade de √°udio */}
      <div>
        <label className="block mb-2 text-sm text-cyan-200/70">Audio Quality</label>
        <div className="flex items-center gap-3">
          <span className="text-xs text-cyan-400/60">Low</span>
          <input
            title="Audio Quality"
            type="range"
            min="0"
            max="100"
            value={audioQuality}
            onChange={e => setAudioQuality(parseInt(e.target.value))}
            className="flex-1 accent-cyan-400"
          />
          <span className="text-xs text-cyan-400/60">High</span>
        </div>
      </div>

      {/* Processamento de √°udio */}
      <div>
        <h3 className="text-cyan-300 mb-2">Audio Processing</h3>
        
        <div className="flex items-center mb-2">
          <input
            type="checkbox"
            id="autoGainControl"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={autoGainControl}
            onChange={e => setAutoGainControl(e.target.checked)}
          />
          <label htmlFor="autoGainControl" className="text-cyan-100/80">Auto Gain Control</label>
        </div>
        
        <div className="flex items-center mb-2">
          <input
            type="checkbox"
            id="noiseSuppression"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={noiseSuppression}
            onChange={e => setNoiseSuppression(e.target.checked)}
          />
          <label htmlFor="noiseSuppression" className="text-cyan-100/80">Noise Suppression</label>
        </div>
        
        <div className="flex items-center">
          <input
            type="checkbox"
            id="echoCancellation"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={echoCancellation}
            onChange={e => setEchoCancellation(e.target.checked)}
          />
          <label htmlFor="echoCancellation" className="text-cyan-100/80">Echo Cancellation</label>
        </div>
      </div>
    </div>
  );
};

export default AudioSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { SelectedDevices } from "../../../../context";
import AudioControls from "../AudioControls";
import LanguageSelector from "../LanguageSelector";

/**
 * Componente simplificado de configura√ß√µes de √°udio
 * Apenas: Language e Device selection
 */
interface AudioSettingsSimpleProps {
  // Language
  language: string;
  setLanguage: (value: string) => void;

  // Device selection
  isMicrophoneOn: boolean;
  setIsMicrophoneOn: (value: boolean) => void;
  isSystemAudioOn: boolean;
  setIsSystemAudioOn: (value: boolean) => void;
  audioDevices: MediaDeviceInfo[];
  selectedDevices: SelectedDevices;
  handleDeviceChange: (deviceId: string, isSystemAudio: boolean) => void;
}

const AudioSettingsSimple: React.FC<AudioSettingsSimpleProps> = ({
  // Language
  language,
  setLanguage,

  // Device selection
  isMicrophoneOn,
  setIsMicrophoneOn,
  isSystemAudioOn,
  setIsSystemAudioOn,
  audioDevices,
  selectedDevices,
  handleDeviceChange,
}) => {
  return (
    <div className="space-y-6">
      {/* Language Selection */}
      <div className="pb-5 border-b border-cyan-500/20">
        <h4 className="text-cyan-300 mb-3 font-semibold text-base">Language</h4>
        <LanguageSelector language={language} setLanguage={setLanguage} />
      </div>

      {/* Device Controls */}
      <div>
        <h4 className="text-cyan-300 mb-4 font-semibold text-base">
          Audio Devices
        </h4>
        <AudioControls
          isMicrophoneOn={isMicrophoneOn}
          setIsMicrophoneOn={setIsMicrophoneOn}
          isSystemAudioOn={isSystemAudioOn}
          setIsSystemAudioOn={setIsSystemAudioOn}
          audioDevices={audioDevices}
          selectedDevices={selectedDevices}
          handleDeviceChange={handleDeviceChange}
        />
      </div>
    </div>
  );
};

export default AudioSettingsSimple;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import ModeToggle from './ModeToggle';

/**
 * Componente para configura√ß√µes gerais do Orch-OS
 * Segue os princ√≠pios neurais-simb√≥licos (Single Responsibility)
 */
import { OrchOSMode, OrchOSModeEnum } from '../../../../../services/ModeService';

interface GeneralSettingsProps {
  name: string;
  setName: (value: string) => void;
  applicationMode: OrchOSMode;
  setApplicationMode: (mode: OrchOSMode) => void;
  enableMatrix: boolean;
  setEnableMatrix: (value: boolean) => void;
  matrixDensity: number;
  setMatrixDensity: (value: number) => void;
  enableEffects: boolean;
  setEnableEffects: (value: boolean) => void;
  enableAnimations: boolean;
  setEnableAnimations: (value: boolean) => void;
}

const GeneralSettings: React.FC<GeneralSettingsProps> = ({
  name,
  setName,
  applicationMode,
  setApplicationMode,
  enableMatrix,
  setEnableMatrix,
  matrixDensity,
  setMatrixDensity,
  enableEffects,
  setEnableEffects,
  enableAnimations,
  setEnableAnimations,
}) => {
  return (
    <div className="space-y-4">
      {/* Nome de usu√°rio - identidade simb√≥lica */}
      <div>
        <label htmlFor="userName" className="block text-cyan-200/80 mb-1">User Name</label>
        <input
          type="text"
          id="userName"
          className="w-full p-2 rounded-lg bg-black/30 border-2 border-cyan-400/40 text-white focus:outline-none focus:border-cyan-400"
          value={name}
          onChange={e => setName(e.target.value)}
          placeholder="Enter your name"
        />
      </div>

      {/* Toggle de modo Neural-Simb√≥lico */}
      <div className="pt-2">
        <h3 className="text-cyan-300 mb-2">Neural Processing Mode</h3>
        <ModeToggle mode={applicationMode} onChange={setApplicationMode} />
      </div>

      {/* Quantum Consciousness Matrix */}
      <div className="pt-1">
        <h3 className="text-cyan-300 mb-2">Quantum Consciousness Matrix</h3>
        <div className="flex items-center mb-2">
          <input
            type="checkbox"
            id="enableMatrix"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={enableMatrix}
            onChange={e => setEnableMatrix(e.target.checked)}
          />
          <label htmlFor="enableMatrix" className="text-cyan-100/80">Enable Quantum Visualization</label>
        </div>
        
        <div className="mb-2">
          <label className="block mb-2 text-sm text-cyan-200/70">Particle Density</label>
          <input
            title="Particle Density"
            type="range"
            min="10"
            max="100"
            value={matrixDensity}
            onChange={e => setMatrixDensity(parseInt(e.target.value))}
            className="w-full accent-cyan-400"
            disabled={!enableMatrix}
          />
        </div>
      </div>

      {/* System Performance */}
      <div className="pt-2">
        <h3 className="text-cyan-300 mb-2">System Performance</h3>
        <div className="flex items-center mb-2">
          <input
            type="checkbox"
            id="enableEffects"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={enableEffects}
            onChange={e => setEnableEffects(e.target.checked)}
          />
          <label htmlFor="enableEffects" className="text-cyan-100/80">Enable Visual Effects</label>
        </div>
        
        <div className="flex items-center">
          <input
            type="checkbox"
            id="enableAnimations"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={enableAnimations}
            onChange={e => setEnableAnimations(e.target.checked)}
          />
          <label htmlFor="enableAnimations" className="text-cyan-100/80">Enable Animations</label>
        </div>
      </div>
    </div>
  );
};

export default GeneralSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

export { default as GeneralSettings } from './GeneralSettings';
export { default as InterfaceSettings } from './InterfaceSettings';
export { default as AudioSettings } from './AudioSettings';

export { default as ModeToggle } from './ModeToggle';
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';

/**
 * Componente para configura√ß√µes de interface do quantum dashboard
 * Segue os princ√≠pios SOLID e Clean Architecture do Orch-OS
 */
interface InterfaceSettingsProps {
  darkMode: boolean;
  setDarkMode: (value: boolean) => void;
  enableNeumorphism: boolean;
  setEnableNeumorphism: (value: boolean) => void;
  enableGlassmorphism: boolean;
  setEnableGlassmorphism: (value: boolean) => void;
  panelTransparency: number;
  setPanelTransparency: (value: number) => void;
  colorTheme: string;
  setColorTheme: (value: string) => void;
}

const InterfaceSettings: React.FC<InterfaceSettingsProps> = ({
  darkMode,
  setDarkMode,
  enableNeumorphism,
  setEnableNeumorphism,
  enableGlassmorphism,
  setEnableGlassmorphism,
  panelTransparency,
  setPanelTransparency,
  colorTheme,
  setColorTheme
}) => {
  return (
    <div className="space-y-4">
      {/* Appearance */}
      <div>
        <h3 className="text-cyan-300 mb-2">Visual Appearance</h3>
        
        <div className="flex items-center mb-3">
          <input
            type="checkbox"
            id="darkMode"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={darkMode}
            onChange={e => setDarkMode(e.target.checked)}
          />
          <label htmlFor="darkMode" className="text-cyan-100/80">Dark Mode</label>
        </div>
        
        <div className="flex items-center mb-3">
          <input
            type="checkbox"
            id="enableGlassmorphism"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={enableGlassmorphism}
            onChange={e => setEnableGlassmorphism(e.target.checked)}
          />
          <label htmlFor="enableGlassmorphism" className="text-cyan-100/80">Glassmorphic Effects</label>
        </div>
        
        <div className="flex items-center mb-2">
          <input
            type="checkbox"
            id="enableNeumorphism"
            className="mr-2 h-5 w-5 rounded-sm accent-cyan-400 bg-black/50"
            checked={enableNeumorphism}
            onChange={e => setEnableNeumorphism(e.target.checked)}
          />
          <label htmlFor="enableNeumorphism" className="text-cyan-100/80">Neumorphic Controls</label>
        </div>
      </div>

      {/* Panel Transparency */}
      <div>
        <label className="block mb-2 text-sm text-cyan-200/70">Panel Transparency</label>
        <div className="flex items-center gap-3">
          <span className="text-xs text-cyan-400/60">Solid</span>
          <input
            title="Panel Transparency"
            type="range"
            min="0"
            max="90"
            value={panelTransparency}
            onChange={e => setPanelTransparency(parseInt(e.target.value))}
            className="flex-1 accent-cyan-400"
          />
          <span className="text-xs text-cyan-400/60">Clear</span>
        </div>
      </div>

      {/* Color Theme Selection */}
      <div>
        <label htmlFor="colorTheme" className="block mb-2 text-sm text-cyan-200/70">Color Theme</label>
        <select
          id="colorTheme"
          className="w-full p-2 rounded bg-black/40 text-white/90 border border-cyan-500/30"
          value={colorTheme}
          onChange={e => setColorTheme(e.target.value)}
          title="Select color theme"
        >
          <option value="quantum-blue">Quantum Blue (Default)</option>
          <option value="neural-purple">Neural Purple</option>
          <option value="cosmic-green">Cosmic Green</option>
          <option value="plasma-orange">Plasma Orange</option>
        </select>
      </div>
    </div>
  );
};

export default InterfaceSettings;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';

/**
 * Neural-Symbolic Mode Toggle Component
 * Controla a sele√ß√£o entre o modo b√°sico e avan√ßado do Orch-OS
 */
import { OrchOSMode, OrchOSModeEnum } from '../../../../../services/ModeService';

interface ModeToggleProps {
  mode: OrchOSMode;
  onChange: (mode: OrchOSMode) => void;
}

const ModeToggle: React.FC<ModeToggleProps> = ({ mode, onChange }) => {
  // Symbolic: All mode checks use enum for clarity and type safety
  const isBasic = mode === OrchOSModeEnum.BASIC;
  const isAdvanced = mode === OrchOSModeEnum.ADVANCED;

  return (
    <div className="flex flex-col items-center">
      <div className="w-full max-w-xs backdrop-blur-md bg-black/40 rounded-full p-1 flex relative overflow-hidden border border-cyan-500/30 shadow-[0_0_15px_rgba(0,200,255,0.2)]">
        {/* Symbolic: Glow indicator moves according to mode */}
        <div 
          className={`absolute inset-y-1 w-1/2 rounded-full transition-transform duration-500 ease-quantum ${
            isBasic
              ? 'left-1 bg-gradient-to-r from-cyan-500/40 to-blue-500/40 shadow-[0_0_20px_5px_rgba(56,189,248,0.35)]'
              : 'right-1 left-auto bg-gradient-to-r from-blue-500/40 to-purple-600/40 shadow-[0_0_20px_5px_rgba(147,51,234,0.35)]'
          }`}
        />
        
        {/* Symbolic: Use enum for mode selection */}
        <button 
          className={`flex-1 py-2 px-2 rounded-full z-10 transition-colors duration-300 ${
            isBasic ? 'text-white font-medium' : 'text-white/60'
          }`}
          onClick={() => onChange(OrchOSModeEnum.BASIC)}
        >
          Basic Mode
        </button>
        
        <button 
          className={`flex-1 py-2 px-2 rounded-full z-10 transition-colors duration-300 ${
            isAdvanced ? 'text-white font-medium' : 'text-white/60'
          }`}
          onClick={() => onChange(OrchOSModeEnum.ADVANCED)}
        >
          Advanced Mode
        </button>
      </div>
      
      {/* Symbolic: Mode description uses enum for clarity */}
      <p className="text-xs text-cyan-300/70 mt-2 text-center max-w-xs">
        {isBasic
          ? 'Using HuggingFace models and local database storage.' 
          : 'Using Deepgram, OpenAI and Pinecone neural infrastructure.'}
      </p>
    </div>
  );
};

export default ModeToggle;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { SettingsFooterProps } from "./types";

/**
 * Componente para o rodap√© do modal de configura√ß√µes
 * Implementa o princ√≠pio de responsabilidade √∫nica isolando
 * a interface de a√ß√µes do usu√°rio
 */
const SettingsFooter: React.FC<SettingsFooterProps> = ({ onClose, saveSettings }) => {
  // Handler para salvar configura√ß√µes e fechar
  const handleApplyChanges = () => {
    saveSettings();
    onClose();
  };
  
  return (
    <div className="flex justify-end space-x-4 mt-8">
      <button 
        className="px-6 py-2 bg-black/40 text-cyan-400/80 rounded hover:bg-black/60 hover:text-cyan-300 transition-all"
        onClick={onClose}
      >
        Cancel
      </button>
      <button 
        className="px-6 py-2 bg-gradient-to-r from-cyan-500/30 to-blue-500/30 text-cyan-300 rounded hover:from-cyan-500/40 hover:to-blue-500/40 transition-all shadow-[0_0_10px_rgba(0,200,255,0.2)] backdrop-blur-sm"
        onClick={handleApplyChanges}
      >
        Apply Changes
      </button>
    </div>
  );
};

export default SettingsFooter;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { SettingsHeaderProps } from "./types";

/**
 * Componente para o cabe√ßalho do modal de configura√ß√µes
 * Separado seguindo o princ√≠pio de responsabilidade √∫nica (SRP)
 */
const SettingsHeader: React.FC<SettingsHeaderProps> = ({ onClose }) => {
  return (
    <>
      <button
        className="orchos-btn-circle absolute top-4 right-4"
        onClick={onClose}
        title="Close"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
          <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
        </svg>
      </button>
      
      <h2 className="text-2xl font-bold mb-4 text-center tracking-wide bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-500 bg-clip-text text-transparent drop-shadow-[0_0_12px_rgba(0,240,255,0.5)] orchos-title">
        Quantum System Settings
      </h2>
    </>
  );
};

export default SettingsHeader;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { SettingsNavigationProps } from "./types";

/**
 * Componente para a navega√ß√£o entre as abas do modal de configura√ß√µes
 * Simbolicamente representa o cortex de navega√ß√£o entre contextos neurais de configura√ß√£o
 */
const SettingsNavigation: React.FC<SettingsNavigationProps> = ({ 
  activeTab, 
  setActiveTab 
}) => {
  return (
    <div className="flex space-x-2 mb-6 border-b border-cyan-400/30 pb-2">
      <button 
        className={`px-4 py-2 rounded-t-lg ${activeTab === 'general' ? 'bg-cyan-500/20 text-cyan-300' : 'text-cyan-400/60 hover:text-cyan-300'} transition-all duration-200`}
        onClick={() => setActiveTab('general')}
      >
        General
      </button>
      <button 
        className={`px-4 py-2 rounded-t-lg ${activeTab === 'interface' ? 'bg-cyan-500/20 text-cyan-300' : 'text-cyan-400/60 hover:text-cyan-300'} transition-all duration-200`}
        onClick={() => setActiveTab('interface')}
      >
        Interface
      </button>
      <button 
        className={`px-4 py-2 rounded-t-lg ${activeTab === 'audio' ? 'bg-cyan-500/20 text-cyan-300' : 'text-cyan-400/60 hover:text-cyan-300'} transition-all duration-200`}
        onClick={() => setActiveTab('audio')}
      >
        Audio
      </button>
      <button 
        className={`px-4 py-2 rounded-t-lg ${activeTab === 'advanced' ? 'bg-cyan-500/20 text-cyan-300' : 'text-cyan-400/60 hover:text-cyan-300'} transition-all duration-200`}
        onClick={() => setActiveTab('advanced')}
      >
        Advanced
      </button>
    </div>
  );
};

export default SettingsNavigation;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { OrchOSMode } from "../../../../../services/ModeService";

// Interfaces para props compartilhados entre componentes

export interface SettingsModalProps {
  show: boolean;
  onClose: () => void;
}

export interface SettingsNavigationProps {
  activeTab: TabType;
  setActiveTab: (tab: TabType) => void;
}

export interface SettingsHeaderProps {
  onClose: () => void;
}

export interface SettingsFooterProps {
  onClose: () => void;
  saveSettings: () => void;
}

export type TabType = "general" | "interface" | "audio" | "advanced";

export type OpenSectionType =
  | "pinecone"
  | "chatgpt"
  | "deepgram"
  | "ollama"
  | null;

// Interface para o state completo das configura√ß√µes
export interface SettingsState {
  // Estado de navega√ß√£o e se√ß√µes
  openSection: OpenSectionType;
  setOpenSection: (section: OpenSectionType) => void;
  activeTab: TabType;
  setActiveTab: (tab: TabType) => void;

  // General
  name: string;
  setName: (name: string) => void;
  enableMatrix: boolean;
  setEnableMatrix: (enable: boolean) => void;
  matrixDensity: number;
  setMatrixDensity: (density: number) => void;
  enableEffects: boolean;
  setEnableEffects: (enable: boolean) => void;
  enableAnimations: boolean;
  setEnableAnimations: (enable: boolean) => void;

  // Interface
  darkMode: boolean;
  setDarkMode: (enable: boolean) => void;
  enableNeumorphism: boolean;
  setEnableNeumorphism: (enable: boolean) => void;
  enableGlassmorphism: boolean;
  setEnableGlassmorphism: (enable: boolean) => void;
  panelTransparency: number;
  setPanelTransparency: (transparency: number) => void;
  colorTheme: string;
  setColorTheme: (theme: string) => void;

  // Audio
  audioQuality: number;
  setAudioQuality: (quality: number) => void;
  autoGainControl: boolean;
  setAutoGainControl: (enable: boolean) => void;
  noiseSuppression: boolean;
  setNoiseSuppression: (enable: boolean) => void;
  echoCancellation: boolean;
  setEchoCancellation: (enable: boolean) => void;
  enhancedPunctuation: boolean;
  setEnhancedPunctuation: (enable: boolean) => void;
  speakerDiarization: boolean;
  setSpeakerDiarization: (enable: boolean) => void;

  // ChatGPT, Deepgram & Pinecone
  chatgptApiKey: string;
  setChatgptApiKey: (key: string) => void;
  chatgptModel: string;
  setChatgptModel: (model: string) => void;
  chatgptTemperature: number;
  setChatgptTemperature: (temp: number) => void;
  chatgptMaxTokens: number;
  setChatgptMaxTokens: (tokens: number) => void;
  openaiEmbeddingModel: string;
  setOpenaiEmbeddingModel: (model: string) => void;

  // HuggingFace
  hfModel: string;
  setHfModel: (model: string) => void;
  hfEmbeddingModel: string;
  setHfEmbeddingModel: (model: string) => void;

  // Deepgram
  deepgramApiKey: string;
  setDeepgramApiKey: (key: string) => void;
  deepgramModel: string;
  setDeepgramModel: (model: string) => void;
  deepgramLanguage: string;
  setDeepgramLanguage: (language: string) => void;
  deepgramTier: string;
  setDeepgramTier: (tier: string) => void;

  // Ollama
  ollamaModel: string;
  setOllamaModel: (model: string) => void;
  ollamaEmbeddingModel: string;
  setOllamaEmbeddingModel: (model: string) => void;
  ollamaEnabled: boolean;
  setOllamaEnabled: (enabled: boolean) => void;

  // Transcri√ß√£o
  transcriptionEnabled: boolean;
  setTranscriptionEnabled: (enable: boolean) => void;
  speakerIdentification: boolean;
  setSpeakerIdentification: (enable: boolean) => void;

  // Pinecone
  pineconeApiKey: string;
  setPineconeApiKey: (key: string) => void;
  pineconeEnvironment: string;
  setPineconeEnvironment: (env: string) => void;
  pineconeIndex: string;
  setPineconeIndex: (index: string) => void;

  // Interface adicional
  theme: string;
  setTheme: (theme: string) => void;
  uiDensity: string;
  setUiDensity: (density: string) => void;
  showAdvancedSettings: boolean;
  setShowAdvancedSettings: (show: boolean) => void;

  // Debug
  debugMode: boolean;
  setDebugMode: (enable: boolean) => void;
  logLevel: string;
  setLogLevel: (level: string) => void;

  // Orch-OS Mode
  applicationMode: OrchOSMode;
  setApplicationMode: (mode: OrchOSMode) => void;

  // M√©todos
  saveSettings: () => void;
}

// Props espec√≠ficos para ApiSettings (mantido para compatibilidade)
export interface ApiSettingsProps {
  applicationMode: OrchOSMode;
  setApplicationMode: (mode: OrchOSMode) => void;
  pineconeApiKey: string;
  setPineconeApiKey: (key: string) => void;
  chatgptApiKey: string;
  setChatgptApiKey: (key: string) => void;
  chatgptModel: string;
  setChatgptModel: (model: string) => void;
  openaiEmbeddingModel: string;
  setOpenaiEmbeddingModel: (model: string) => void;
  hfModel: string;
  setHfModel: (model: string) => void;
  hfEmbeddingModel: string;
  setHfEmbeddingModel: (model: string) => void;
  deepgramApiKey: string;
  setDeepgramApiKey: (key: string) => void;
  deepgramModel: string;
  setDeepgramModel: (model: string) => void;
  deepgramLanguage: string;
  setDeepgramLanguage: (language: string) => void;
  // Ollama
  ollamaModel: string;
  setOllamaModel: (model: string) => void;
  ollamaEmbeddingModel: string;
  setOllamaEmbeddingModel: (model: string) => void;
  ollamaEnabled: boolean;
  setOllamaEnabled: (enabled: boolean) => void;
  openSection: OpenSectionType;
  setOpenSection: (section: OpenSectionType) => void;
}
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import { useState, useMemo } from "react";
import { SettingsState } from './types';
import { useNavigationState } from './hooks/useNavigationState';
import { useGeneralSettings } from './hooks/useGeneralSettings';
import { useInterfaceSettings } from './hooks/useInterfaceSettings';
import { useAudioSettings } from './hooks/useAudioSettings';
import { useApiSettings } from './hooks/useApiSettings';
import { useDebugSettings } from './hooks/useDebugSettings';
import { OrchOSMode, ModeService } from '../../../../../services/ModeService';

/**
 * Hook orquestrador para gerenciamento de estado neural-simb√≥lico das configura√ß√µes
 * Implementa o princ√≠pio de responsabilidade √∫nica e composi√ß√£o
 * agregando os hooks especializados por dom√≠nio
 */
export const useSettingsState = (show: boolean): SettingsState => {
  // Composi√ß√£o de hooks especializados por dom√≠nio
  const navigation = useNavigationState();
  const general = useGeneralSettings();
  const interfaceSettings = useInterfaceSettings();
  const audio = useAudioSettings(show);
  const api = useApiSettings();
  const debug = useDebugSettings();
  
  // Modo de aplica√ß√£o (B√°sico/Avan√ßado)
  const [applicationMode, setApplicationModeState] = useState<OrchOSMode>(() => ModeService.getMode());
  
  // Handler para altera√ß√£o do modo com persist√™ncia
  const setApplicationMode = (mode: OrchOSMode) => {
    ModeService.setMode(mode);
    setApplicationModeState(mode);
  };
  
  // Fun√ß√£o unificada para salvar todas as configura√ß√µes
  const saveSettings = () => {
    // Salva as configura√ß√µes de cada dom√≠nio
    general.saveGeneralSettings();
    interfaceSettings.saveInterfaceSettings();
    audio.saveAudioSettings();
    api.saveApiSettings();
    debug.saveDebugSettings();
  };
  
  // Combina todos os estados e fun√ß√µes dos hooks especializados
  // Memoiza o objeto para evitar renders desnecess√°rios
  return useMemo(() => ({
    // Navega√ß√£o
    ...navigation,
    // General
    ...general,
    // Interface
    ...interfaceSettings,
    // Audio e Transcri√ß√£o
    ...audio,
    // API (OpenAI, Deepgram, HuggingFace, Pinecone)
    ...api,
    // Debug
    ...debug,
    // Modo da aplica√ß√£o
    applicationMode,
    setApplicationMode,
    // A√ß√£o unificada
    saveSettings
  }), [
    // Depend√™ncias: todos os objetos retornados pelos hooks especializados e applicationMode
    navigation,
    general,
    interfaceSettings,
    audio,
    api,
    debug,
    applicationMode,
    setApplicationMode,
    saveSettings
  ]);
};
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { AudioControlsProps } from "../types/interfaces";
import DeviceSelector from "./DeviceSelector";
import ToggleSwitch from "./ToggleSwitch";

const AudioControls: React.FC<AudioControlsProps> = ({
  isMicrophoneOn,
  setIsMicrophoneOn,
  isSystemAudioOn,
  setIsSystemAudioOn,
  audioDevices,
  selectedDevices,
  handleDeviceChange,
}) => {
  return (
    <div className="space-y-4">
      {/* Microphone Section */}
      <div className="space-y-2">
        <ToggleSwitch
          label="Microphone"
          isOn={isMicrophoneOn}
          onChange={() => setIsMicrophoneOn(!isMicrophoneOn)}
          title="Toggle microphone"
        />

        {isMicrophoneOn && (
          <div className="ml-0 animate-fadeIn">
            <DeviceSelector
              devices={audioDevices}
              selectedId={selectedDevices.microphone ?? ""}
              onChange={(deviceId) => handleDeviceChange(deviceId, false)}
              title="Select microphone"
              isSystemAudio={false}
            />
          </div>
        )}
      </div>

      {/* System Audio Section */}
      <div className="space-y-2">
        <ToggleSwitch
          label="System Audio"
          isOn={isSystemAudioOn}
          onChange={() => setIsSystemAudioOn(!isSystemAudioOn)}
          title="Toggle system audio"
        />

        {isSystemAudioOn && (
          <div className="ml-0 animate-fadeIn">
            <DeviceSelector
              devices={audioDevices}
              selectedId={selectedDevices.systemAudio ?? ""}
              onChange={(deviceId) => handleDeviceChange(deviceId, true)}
              title="Select system audio source"
              isSystemAudio={true}
            />
          </div>
        )}
      </div>
    </div>
  );
};

export default AudioControls;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import CognitionTimeline from '../../CognitionTimeline/CognitionTimeline';
import { CognitionEvent } from '../../../context/deepgram/types/CognitionEvent';
import styles from '../components/TextControls.module.css';

interface CognitionLogSectionProps {
  cognitionEvents: CognitionEvent[];
  exporters: { label: string }[];
  exportEvents: (label: string) => void;
  clearEvents: () => void;
}

const CognitionLogSection: React.FC<CognitionLogSectionProps> = ({
  cognitionEvents,
  exporters,
  exportEvents,
  clearEvents
}) => {
  return (
    <div className="flex flex-col h-full">
      {/* Button row centralizada Vision Pro Style */}
      <div className="orchos-cognition-logs-buttons justify-center items-center gap-2 mb-2.5 flex flex-wrap w-full" style={{ position: 'relative', zIndex: 10 }}>
        <button
          className={`${styles['orchos-btn-glass']} ${styles['orchos-btn-glow']} ${styles['orchos-btn-action']} px-3 py-1 flex items-center justify-center mx-[0.18rem]`}
          onClick={() => exportEvents('Export cognitive log (JSON)')}
          title="Export as JSON"
          style={{ minWidth: '72px', height: '32px', fontSize: '0.92rem', fontWeight: 500 }}
        >
          <span className="align-middle">JSON</span>
        </button>
        <button
          className={`${styles['orchos-btn-glass']} ${styles['orchos-btn-glow']} ${styles['orchos-btn-action']} px-3 py-1 flex items-center justify-center`}
          onClick={() => exportEvents('Export cognitive log (TXT)')}
          title="Export as TXT"
          style={{ minWidth: '72px', height: '32px', fontSize: '0.92rem', fontWeight: 500 }}
        >
          <span className="align-middle">TXT</span>
        </button>
        <button
          className={`${styles['orchos-btn-glass']} ${styles['orchos-btn-glow']} ${styles['orchos-btn-action']} px-3 py-1 flex items-center justify-center`}
          onClick={clearEvents}
          title="Clear all logs"
          style={{ minWidth: '72px', height: '32px', fontSize: '0.92rem', fontWeight: 500 }}
        >
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><ellipse cx="8" cy="8" rx="6.5" ry="4.5" stroke="#ff4dd2" strokeWidth="1.2"/><path d="M6 6l4 4M10 6l-4 4" stroke="#ff4dd2" strokeWidth="1.3" strokeLinecap="round"/></svg>
          <span className="hidden md:inline ml-1 align-middle">Clear</span>
        </button>
      </div>
      <div className="orchos-cognition-logs-list">
        <CognitionTimeline events={cognitionEvents} />
      </div>
    </div>
  );
};

export default CognitionLogSection;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import { ConnectionDiagnosticsProps } from '../types/interfaces';

const ConnectionDiagnostics: React.FC<ConnectionDiagnosticsProps> = ({
  connectionDetails,
  setConnectionDetails,
  getConnectionStatus,
  showToast,
  disconnectFromDeepgram,
  connectToDeepgram,
  waitForConnectionState,
  hasActiveConnection,
  ConnectionState
}) => {
  const checkConnectionStatus = () => {
    if (getConnectionStatus) {
      const status = getConnectionStatus();
      setConnectionDetails(status);

      if (status.active) {
        showToast("Diagnostics", "Connection is active and ready to use", "success");
      } else if (status.hasConnectionObject && status.readyState !== 1) {
        showToast("Diagnostics", `Connection exists but ReadyState = ${status.readyState} (expected: 1)`, "error");
      } else if (!status.hasConnectionObject && status.stateRef === 'OPEN') {
        showToast("Diagnostics", "State inconsistent: marked as OPEN but connection is null", "error");
      } else {
        showToast("Diagnostics", `Connection is not active (${status.stateRef})`, "error");
      }
    }
  };

  const forceReconnect = async () => {
    try {
      disconnectFromDeepgram();
      await new Promise(resolve => setTimeout(resolve, 1000));
      await connectToDeepgram();
      const connected = await waitForConnectionState(ConnectionState.OPEN, 5000);
      if (connected && hasActiveConnection()) {
        showToast("Diagnostics", "Reconnection successful", "success");
      } else {
        showToast("Diagnostics", "Reconnection failed", "error");
      }
    } catch (error) {
      console.error("Error forcing reconnection:", error);
      showToast("Diagnostics", "Error forcing reconnection", "error");
    }
  };

  return (
    <div className="mt-4 p-3 bg-gray-800 rounded-md text-xs">
      <div className="flex justify-between items-center mb-2">
        <div className="font-medium">Connection Diagnostics</div>
        <button
          onClick={checkConnectionStatus}
          className="text-xs bg-blue-600 px-2 py-1 rounded hover:bg-blue-700"
        >
          Check Now
        </button>
      </div>
      {(connectionDetails && typeof connectionDetails === "object" && connectionDetails !== null && "state" in connectionDetails) ? (
        <div className="space-y-2">
          <div className="grid grid-cols-2 gap-x-2">
            <div>Current state:</div>
            <div className={
              typeof connectionDetails.state === 'string' && connectionDetails.state === 'OPEN' ? 'text-green-400' :
                typeof connectionDetails.state === 'string' && connectionDetails.state === 'CONNECTING' ? 'text-yellow-400' :
                  'text-red-400'
            }>
              {typeof connectionDetails.state === 'string' ? connectionDetails.state : ''}
            </div>
            <div>State (ref):</div>
            <div className={
              typeof connectionDetails.stateRef === 'string' && connectionDetails.stateRef === 'OPEN' ? 'text-green-400' :
                typeof connectionDetails.stateRef === 'string' && connectionDetails.stateRef === 'CONNECTING' ? 'text-yellow-400' :
                  'text-red-400'
            }>
              {typeof connectionDetails.stateRef === 'string' ? connectionDetails.stateRef : ''}
            </div>
            <div>Connection object:</div>
            <div className={connectionDetails.hasConnectionObject ? 'text-green-400' : 'text-red-400'}>
              {connectionDetails.hasConnectionObject ? 'Available' : 'Not available'}
            </div>
            <div>WebSocket ReadyState:</div>
            <div className={
              connectionDetails.readyState === 1 ? 'text-green-400' :
                connectionDetails.readyState === 0 ? 'text-yellow-400' :
                  'text-red-400'
            }>
              {connectionDetails.readyState === null ? 'N/A' :
                connectionDetails.readyState === 0 ? '0 (CONNECTING)' :
                  connectionDetails.readyState === 1 ? '1 (OPEN)' :
                    connectionDetails.readyState === 2 ? '2 (CLOSING)' :
                      connectionDetails.readyState === 3 ? '3 (CLOSED)' : 'Unknown'}
            </div>
            <div>Connection active:</div>
            <div className={connectionDetails.active ? 'text-green-400' : 'text-red-400'}>
              {connectionDetails.active ? 'Yes ‚úÖ' : 'No ‚ùå'}
            </div>
          </div>
          <div className="pt-2 flex space-x-2">
            <button
              onClick={disconnectFromDeepgram}
              className="flex-1 bg-red-700 p-2 rounded hover:bg-red-800"
            >
              Disconnect
            </button>
            <button
              onClick={forceReconnect}
              className="flex-1 bg-green-700 p-2 rounded hover:bg-green-800"
            >
              Force Reconnect
            </button>
          </div>
        </div>
      ) : (
        <div className="text-gray-400">Click on &quot;Check Now&quot; to view connection details</div>
      )}
    </div>
  );
};

export default ConnectionDiagnostics;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";

interface DeviceSelectorProps {
  devices: MediaDeviceInfo[];
  selectedId?: string;
  onChange: (id: string) => void;
  title: string;
  isSystemAudio: boolean;
}

const DeviceSelector: React.FC<DeviceSelectorProps> = ({
  devices,
  selectedId,
  onChange,
  title,
  isSystemAudio,
}) => {
  // Filter devices based on type
  const filteredDevices = devices.filter((device) => {
    const label = device.label.toLowerCase();
    const isSystemDevice =
      label.includes("blackhole") || label.includes("dipper");
    return isSystemAudio ? isSystemDevice : !isSystemDevice;
  });

  return (
    <select
      title={title}
      className="w-full p-2.5 rounded-lg bg-black/40 text-white/90 text-sm border border-cyan-500/20 focus:border-cyan-500/50 focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all"
      value={selectedId || ""}
      onChange={(e) => onChange(e.target.value)}
    >
      {filteredDevices.length === 0 && (
        <option value="" disabled>
          No {isSystemAudio ? "system audio" : "microphone"} devices found
        </option>
      )}
      {filteredDevices.map((device) => (
        <option key={device.deviceId} value={device.deviceId}>
          {device.label || `Device ${device.deviceId.substring(0, 5)}...`}
        </option>
      ))}
    </select>
  );
};

export default DeviceSelector;
/* SPDX-License-Identifier: MIT OR Apache-2.0
   Copyright (c) 2025 Guilherme Ferrari Brescia */

/* Painel Principal de Diagn√≥stico - neural-simb√≥lico Orch-OS refinado */
.diagnosticsPanel {
  background: rgba(11, 20, 38, 0.98);
  border-radius: 12px;
  box-shadow: 0 0 18px 2px #00faff22, inset 0 0 0 1px #00faff10;
  padding: 12px 16px 8px 16px;
  width: 100%;
  max-width: 340px;
  color: #eafcff;
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  border: 1px solid #00faff;
  animation: panelFadeIn 0.3s ease-out, borderGlow 4s infinite alternate;
  position: relative;
  overflow: hidden;
}

@keyframes borderGlow {
  0% { border-color: #00faff80; }
  50% { border-color: #00faff; }
  100% { border-color: #00faff80; }
}

/* Efeito de borda brilhante */
.diagnosticsPanel::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 16px;
  pointer-events: none;
  z-index: -1;
  box-shadow: 0 0 15px rgba(0, 250, 255, 0.5);
}

@keyframes panelFadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* T√≠tulo do Painel */
.panelTitle {
  font-size: 1.25rem;
  font-weight: 700;
  color: #00faff;
  margin-bottom: 0.5rem;
  padding-bottom: 0.25rem;
  border-bottom: 1px solid;
  border-image: linear-gradient(90deg, #00faff11, #00faff66, #00faff11) 1;
  text-align: center;
  font-family: 'Orbitron', 'Inter', -apple-system, sans-serif;
  letter-spacing: 0.02em;
  text-shadow: 0 0 6px #00faff44;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.panelTitle::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 25%;
  right: 25%;
  height: 1px;
  background: linear-gradient(90deg, transparent, #00faff, transparent);
  opacity: 0.6;
  animation: glowLine 3s infinite alternate;
}

@keyframes glowLine {
  0% { opacity: 0.3; }
  100% { opacity: 0.8; }
}

/* Tabela de Status */
.statusTable {
  width: 100%;
  border-spacing: 0 3px;
  border-collapse: separate;
  margin-bottom: 0.6rem;
  table-layout: fixed;
}

.statusRow {
  height: 24px;
  position: relative;
}

.statusRow:not(:last-child)::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 8%;
  right: 8%;
  height: 1px;
  background: linear-gradient(90deg, transparent, #00faff22, transparent);
}

.statusCell {
  padding: 0.15rem 0.1rem;
  vertical-align: middle;
}

.statusCell:first-child {
  text-align: left;
  padding-right: 0.5rem;
  width: 45%;
}

.statusCell:last-child {
  text-align: right;
  width: 55%;
}

/* Labels */
.statusLabel {
  display: inline-block;
  white-space: nowrap;
  text-align: left;
  font-size: 0.88rem;
  color: #00faff;
  font-weight: 500;
  letter-spacing: 0.01em;
  opacity: 0.9;
  transition: color 0.2s ease;
}

.statusLabel:hover {
  color: #fff;
  text-shadow: 0 0 4px rgba(0, 250, 255, 0.5);
}

/* Valores dos Estados */
.statusValue {
  display: inline-block;
  font-size: 0.86rem;
  font-weight: 700;
  padding: 0.12rem 0.65rem;
  border-radius: 4px;
  min-width: 78px;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 0.02em;
  border-width: 1px;
  border-style: solid;
  background-color: rgba(11, 20, 38, 0.5);
  font-family: 'Orbitron', 'Inter', -apple-system, sans-serif;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  white-space: nowrap;
  transform: translateY(0);
  transition: transform 0.15s, filter 0.15s, background-color 0.15s;
}

/* Status CLOSED (amarelo neural) */
.statusOpen, .statusReady, .statusUnavailable {
  color: #ffe066;
  border-color: #ffe066;
  background-color: rgba(255, 224, 102, 0.06);
  transition: all 0.3s;
}

.statusOpen:hover, .statusReady:hover, .statusUnavailable:hover {
  background-color: rgba(255, 224, 102, 0.1);
  box-shadow: 0 0 8px rgba(255, 224, 102, 0.3);
}

/* Status AVAILABLE (ciano neural) */
.statusYes {
  color: #00faff;
  border-color: #00faff;
  background-color: rgba(0, 250, 255, 0.06);
  animation: statusPulse 2s infinite alternate;
}

@keyframes statusPulse {
  0% {
    box-shadow: 0 0 4px rgba(0, 250, 255, 0.2);
    text-shadow: 0 0 0 transparent;
  }
  100% {
    box-shadow: 0 0 6px rgba(0, 250, 255, 0.5);
    text-shadow: 0 0 3px rgba(0, 250, 255, 0.3);
  }
}

.statusYes:hover {
  background-color: rgba(0, 250, 255, 0.1);
  filter: brightness(1.1);
}

/* Status NO ‚úó (vermelho neural) */
.statusNo, .statusError {
  color: #ff4455;
  border-color: #ff4455;
  background-color: rgba(255, 68, 85, 0.06);
  transition: all 0.3s;
}

.statusNo:hover, .statusError:hover {
  background-color: rgba(255, 68, 85, 0.1);
  box-shadow: 0 0 8px rgba(255, 68, 85, 0.3);
}

/* Container de Bot√µes */
.buttonContainer {
  display: flex;
  flex-direction: row;
  gap: 0.5rem;
  margin-top: 0.8rem;
  justify-content: flex-end;
  padding: 0.1rem 0;
}

/* Bot√µes de A√ß√£o neural-simb√≥lico refinados */
.button {
  min-width: 124px;
  max-width: 170px;
  height: 36px;
  padding: 0 1em;
  border-radius: 10px;
  font-size: 0.92rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.25s ease;
  text-align: center;
  border: 1px solid transparent;
  background: #101a2a;
  color: #00faff;
  box-shadow: 0 2px 8px 0 #00faff22;
  display: flex;
  align-items: center;
  justify-content: center;
  letter-spacing: 0.01em;
  position: relative;
  overflow: hidden;
  white-space: nowrap;
}

.button::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(120deg, transparent 20%, rgba(255,255,255,0.1) 40%, transparent 60%);
  transform: translateX(-100%);
  transition: transform 0.5s ease;
}

.button:hover::before {
  transform: translateX(100%);
}

.button:active, .button:focus {
  filter: brightness(1.06) drop-shadow(0 0 4px #00faff);
  transform: translateY(-1px);
}
.disconnectButton {
  border: 1px solid #ff4455;
  color: #ff4455;
  background: #17172a;
}
.disconnectButton:hover {
  background: rgba(255, 68, 85, 0.15);
  color: #fff;
  border-color: #ff4455;
  box-shadow: 0 2px 12px rgba(255, 68, 85, 0.3);
}
.disconnectButton:active {
  background: rgba(255, 68, 85, 0.25);
  transform: translateY(1px);
}
.reconnectButton {
  border: 1px solid #00faff;
  color: #fff;
  background: linear-gradient(90deg, #00faff 0%, #1e90ff 100%);
  min-width: 146px; /* Espec√≠fico para garantir que caiba o texto 'Force Reconnect' */
}
.reconnectButton:hover {
  filter: brightness(1.1) drop-shadow(0 0 8px #00faff60);
  background: linear-gradient(90deg, #00e1f0 0%, #007cf0 100%);
  color: #fff;
  border-color: #00faff;
}
.reconnectButton:active {
  background: linear-gradient(90deg, #00d1e0 0%, #006ce0 100%);
  transform: translateY(1px);
}

// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import { ConnectionState, MicrophoneState } from '../../../context';
import styles from './DiagnosticsPanel.module.css';

// Mantendo o arquivo mais limpo sem os √≠cones

/**
 * DiagnosticsPanel - Interface cortical para monitoramento de estados neurais
 * Representa os estados de conex√£o dos componentes de input neural (Deepgram e Microfone)
 * seguindo a est√©tica neural-simb√≥lica do Orch-OS
 */
interface DiagnosticsPanelProps {
  connectionState: ConnectionState;
  microphoneState: MicrophoneState;
  onDisconnect?: () => void;
  onReconnect?: () => void;
}

const DiagnosticsPanel: React.FC<DiagnosticsPanelProps> = ({
  connectionState, 
  microphoneState,
  onDisconnect,
  onReconnect
}) => {
  // Determina o estado geral do sistema baseado nos estados dos componentes
  const isFullyConnected = 
    connectionState === ConnectionState.OPEN && 
    (microphoneState === MicrophoneState.Open || microphoneState === MicrophoneState.Ready);

  // Mapeia valor de enum para string leg√≠vel
  const getConnectionStateText = (state: ConnectionState): string => {
    switch (state) {
      case ConnectionState.OPEN:
        return 'OPEN';
      case ConnectionState.CLOSED:
        return 'CLOSED';
      case ConnectionState.CONNECTING:
        return 'CONNECTING';
      case ConnectionState.ERROR:
        return 'ERROR';
      default:
        return 'UNKNOWN';
    }
  };

  const getMicStateText = (state: MicrophoneState): string => {
    switch (state) {
      case MicrophoneState.Open:
        return 'OPEN';
      case MicrophoneState.Ready:
        return 'READY';
      case MicrophoneState.Opening:
        return 'OPENING';
      case MicrophoneState.Error:
        return 'ERROR';
      case MicrophoneState.NotSetup:
        return 'NO';
      default:
        return 'UNKNOWN';
    }
  };

  // Mapeia estado para classe CSS neural-simb√≥lica
  const getConnectionStateClass = (state: ConnectionState): string => {
    switch (state) {
      case ConnectionState.OPEN:
        return styles.statusYes;
      case ConnectionState.CLOSED:
        return styles.statusUnavailable; // Fechado deve usar o amarelo (warning)
      case ConnectionState.CONNECTING:
        return styles.statusUnavailable;
      case ConnectionState.ERROR:
        return styles.statusError;
      default:
        return styles.statusUnavailable;
    }
  };

  const getMicStateClass = (state: MicrophoneState): string => {
    switch (state) {
      case MicrophoneState.Open:
      case MicrophoneState.Ready:
        return styles.statusYes;
      case MicrophoneState.Opening:
        return styles.statusUnavailable;
      case MicrophoneState.Error:
        return styles.statusError;
      case MicrophoneState.NotSetup:
        return styles.statusNo;
      default:
        return styles.statusUnavailable;
    }
  };

  // Manipuladores de eventos para a√ß√µes neurais
  const handleDisconnect = () => {
    if (onDisconnect) onDisconnect();
  };

  const handleReconnect = () => {
    if (onReconnect) onReconnect();
  };

  return (
    <div className={styles.diagnosticsPanel}>
      <h3 className={styles.panelTitle}>Connection Diagnostics</h3>
      
      <table className={styles.statusTable}>
        <tbody>
          <tr className={styles.statusRow}>
            <td className={styles.statusCell}>
              <span className={styles.statusLabel}>Conn. state:</span>
            </td>
            <td className={styles.statusCell}>
              <span className={`${styles.statusValue} ${getConnectionStateClass(connectionState)}`}>
                {getConnectionStateText(connectionState)}
              </span>
            </td>
          </tr>
          <tr className={styles.statusRow}>
            <td className={styles.statusCell}>
              <span className={styles.statusLabel}>Self state:</span>
            </td>
            <td className={styles.statusCell}>
              <span className={`${styles.statusValue} ${getConnectionStateClass(connectionState)}`}>
                {getConnectionStateText(connectionState)}
              </span>
            </td>
          </tr>
          <tr className={styles.statusRow}>
            <td className={styles.statusCell}>
              <span className={styles.statusLabel}>Conn. obj.:</span>
            </td>
            <td className={styles.statusCell}>
              <span className={`${styles.statusValue} ${styles.statusYes}`}>
                {connectionState !== ConnectionState.ERROR ? 'AVAILABLE' : 'ERROR'}
              </span>
            </td>
          </tr>
          <tr className={styles.statusRow}>
            <td className={styles.statusCell}>
              <span className={styles.statusLabel}>Mic state:</span>
            </td>
            <td className={styles.statusCell}>
              <span className={`${styles.statusValue} ${getMicStateClass(microphoneState)}`}>
                {getMicStateText(microphoneState)}
              </span>
            </td>
          </tr>
          <tr className={styles.statusRow}>
            <td className={styles.statusCell}>
              <span className={styles.statusLabel}>Conn. active:</span>
            </td>
            <td className={styles.statusCell}>
              <span className={`${styles.statusValue} ${isFullyConnected ? styles.statusYes : styles.statusNo}`}>
                {isFullyConnected ? 'YES' : 'NO ‚úó'}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div className={styles.buttonContainer}>
        <button 
          className={`${styles.button} ${styles.disconnectButton}`}
          onClick={handleDisconnect}
        >
          Disconnect
        </button>
        <button 
          className={`${styles.button} ${styles.reconnectButton}`}
          onClick={handleReconnect}
        >
          Force Reconnect
        </button>
      </div>
    </div>
  );
};

export default DiagnosticsPanel;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { ImportModalProps } from "../types/interfaces";

const ImportModal: React.FC<ImportModalProps> = ({
  show,
  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  onClose,
  importFile,
  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  setImportFile, 
  importUserName,
  setImportUserName,
  importMode,
  setImportMode,
  importProgress,
  importStage,
  importSummary,
  isImporting,
  handleFileChange,
  handleStartImport,
  handleCloseImportModal
}) => {
  if (!show) return null;
  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/60">
      <div className="bg-gray-900/90 rounded-2xl shadow-2xl p-8 w-full max-w-md relative backdrop-blur-lg ring-2 ring-cyan-400/10">
        <button
          className="orchos-btn-circle absolute top-2 right-2"
          onClick={handleCloseImportModal}
          title="Fechar"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
          </svg>
        </button>
        <h2 className="text-2xl font-bold mb-6 text-center tracking-wide bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-500 bg-clip-text text-transparent drop-shadow-[0_0_12px_rgba(0,240,255,0.5)]" style={{fontFamily:'Orbitron, Inter, sans-serif'}}>Import Neural Data</h2>
        <input
          data-testid="import-user-name"
          type="text"
          className="mb-4 w-full text-white bg-black/30 border-2 border-cyan-400/40 rounded-full p-3 focus:outline-none focus:ring-2 focus:ring-cyan-400/60 placeholder:text-cyan-200/60 text-lg shadow-inner backdrop-blur"
          placeholder="Main user name"
          disabled={isImporting}
          value={importUserName || ''}
          onChange={e => setImportUserName(e.target.value)}
        />
        <label className="block mb-6">
          <span className="block text-cyan-200/80 mb-2 font-medium">Select file</span>
          <div className="flex items-center gap-3">
            <input
              data-testid="import-user-input"
              type="file"
              accept="application/json"
              onChange={handleFileChange}
              className="hidden"
              id="orchos-upload-neural"
              disabled={isImporting}
            />
            <label htmlFor="orchos-upload-neural" className="flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-cyan-500 via-blue-700 to-purple-600 text-white font-semibold shadow-lg cursor-pointer hover:scale-105 transition-all duration-150">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="8" stroke="#00F0FF" strokeWidth="1.5" /><path d="M10 6v5m0 0l2.5-2.5M10 11l-2.5-2.5" stroke="#8F00FF" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/></svg>
              {importFile ? importFile.name : 'Choose file'}
            </label>
          </div>
        </label>
        <div className="mb-6 px-4 py-3 bg-black/30 rounded-xl flex flex-col items-center gap-2 ring-1 ring-cyan-400/10">
          <span className="text-cyan-200/90 font-medium mb-1">Import Mode:</span>
          <div className="flex gap-4">
            <label className="flex items-center gap-2 cursor-pointer text-white/90 hover:text-cyan-300 transition-all">
              <input
                type="radio"
                name="importMode"
                value="overwrite"
                checked={importMode === 'overwrite'}
                onChange={() => setImportMode('overwrite')}
                disabled={isImporting}
                className="accent-cyan-400 w-4 h-4"
              />
              <span>Overwrite all</span>
            </label>
            <label className="flex items-center gap-2 cursor-pointer text-white/90 hover:text-cyan-300 transition-all">
              <input
                type="radio"
                name="importMode"
                value="increment"
                checked={importMode === 'increment'}
                onChange={() => setImportMode('increment')}
                disabled={isImporting}
                className="accent-purple-400 w-4 h-4"
              />
              <span>Increment <span className="text-xs text-cyan-200/60">(add only new)</span></span>
            </label>
          </div>
        </div>
        <button
          type="button"
          className="flex items-center gap-2 justify-center w-full py-3 mt-2 rounded-full font-bold text-lg bg-gradient-to-r from-cyan-400 via-blue-700 to-purple-600 shadow-[0_0_18px_2px_rgba(0,240,255,0.18)] hover:shadow-cyan-400/70 hover:scale-105 transition-all duration-200 ring-2 ring-cyan-400/20 backdrop-blur text-white focus:outline-none focus:ring-4 focus:ring-cyan-400/60 disabled:opacity-60 disabled:cursor-not-allowed mb-4"
          onClick={() => {
            handleStartImport(importUserName);
          }}
          disabled={!importFile || isImporting}
        >
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none" aria-hidden="true"><circle cx="10" cy="10" r="8" stroke="#00F0FF" strokeWidth="1.5" /><path d="M10 6v5m0 0l2.5-2.5M10 11l-2.5-2.5" stroke="#8F00FF" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/></svg>
          {isImporting ? 'Importing...' : 'Start Import'}
        </button>
        {isImporting && (
          <div className="w-full flex flex-col items-center mb-6">
            <div className="relative w-full h-9 rounded-full bg-gradient-to-r from-cyan-900/40 via-blue-900/30 to-purple-900/40 shadow-inner overflow-hidden mt-2 mb-3 ring-1 ring-cyan-400/10">
              <div
                className="absolute top-0 left-0 h-full bg-gradient-to-r from-cyan-400 via-blue-700 to-purple-600 shadow-[0_0_18px_2px_rgba(0,240,255,0.18)] transition-all duration-300"
                style={{ width: `${importProgress}%`, minWidth: importProgress > 0 ? '2.5rem' : 0, borderRadius: '9999px' }}
              >
              </div>
              <div className="absolute top-0 left-0 h-full w-full pointer-events-none"></div>
            </div>
            <span className="text-cyan-300 text-sm font-semibold mt-3 drop-shadow">{importProgress}%</span>
          </div>
        )}
        {isImporting && (
          <div className="mb-2 flex items-center justify-center text-base">
            <span className="mr-2 text-white/70 font-medium">Current stage:</span>
            <span className="font-bold bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-500 bg-clip-text text-transparent drop-shadow-[0_0_8px_rgba(0,240,255,0.3)] animate-pulse">
              {(() => {
                switch (importStage) {
                  case 'parsing': return 'Reading messages';
                  case 'deduplicating': return 'Checking duplicates';
                  case 'generating_embeddings': return 'Generating embeddings';
                  case 'saving': return 'Saving to database';
                  default: return importStage ? importStage : 'Preparing...';
                }
              })()}
            </span>
          </div>
        )}
        {importSummary && (
          <div className="text-green-400 text-sm mt-2" data-testid="import-summary">{importSummary}</div>
        )}

        {importSummary && (
          <div className="text-white/80 text-xs mt-2" data-testid="import-result-details">
            {/* Detailed success case with stats */}
            {importSummary.includes('Imported:') && importSummary.includes('Skipped:') && (
              <>
                Total messages processed: {(() => {
                  const matches = importSummary.match(/Imported: (\d+), Skipped: (\d+)/);
                  if (matches) {
                    return Number(matches[1]) + Number(matches[2]);
                  }
                  return 0;
                })()}<br />
                {importSummary.replace('Import complete! ', '')}
              </>
            )}
            
            {/* Simple success case without stats */}
            {importSummary === 'Import complete!' && (
              <>Import completed successfully with no details available.</>
            )}
            
            {/* Error case */}
            {importSummary.includes('Error:') && (
              <span className="text-red-400">{importSummary}</span>
            )}
          </div>
        )}
      </div>
    </div>
  );
};

export default ImportModal;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React, { useEffect } from "react";
import {
  setOption,
  STORAGE_KEYS,
  subscribeToStorageChanges,
} from "../../../../services/StorageService";

interface LanguageSelectorProps {
  language: string;
  setLanguage: (language: string) => void;
}

const LanguageSelector: React.FC<LanguageSelectorProps> = ({
  language,
  setLanguage,
}) => {
  // Sincroniza com as configura√ß√µes globais
  useEffect(() => {
    // Handler para mudan√ßas no storage
    const handleStorageChange = (key: string, value: any) => {
      if (
        key === STORAGE_KEYS.DEEPGRAM_LANGUAGE &&
        value &&
        value !== language
      ) {
        console.log(
          "üåê LanguageSelector: Sincronizando com configura√ß√µes globais:",
          value
        );
        setLanguage(value);
      }
    };

    // Inscri√ß√£o no sistema de eventos
    const unsubscribe = subscribeToStorageChanges(handleStorageChange);

    // Limpeza ao desmontar
    return unsubscribe;
  }, [language, setLanguage]);

  return (
    <div className="language-selector-wrapper">
      <label className="text-sm text-cyan-200/70 block mb-2">
        Transcription Language
      </label>
      <select
        title="Transcription Language"
        className="w-full p-2.5 rounded-lg bg-black/40 text-white/90 text-sm border border-cyan-500/20 focus:border-cyan-500/50 focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all"
        value={language}
        onChange={(e) => {
          const newLanguage = e.target.value;
          console.log("Language selector changed to:", newLanguage);

          // Atualiza o estado local
          setLanguage(newLanguage);

          // Salva automaticamente no storage do sistema
          setOption(STORAGE_KEYS.DEEPGRAM_LANGUAGE, newLanguage);
          console.log(
            "üíæ Idioma salvo automaticamente no sistema:",
            newLanguage
          );
        }}
      >
        <option value="pt-BR">Portuguese (Brazil)</option>
        <option value="pt-PT">Portuguese (Portugal)</option>
        <option value="en-US">English (United States)</option>
        <option value="en">English (Global)</option>
        <option value="es">Spanish</option>
        <option value="fr">French</option>
        <option value="de">German</option>
        <option value="it">Italian</option>
        <option value="ja">Japanese</option>
        <option value="zh">Chinese</option>
      </select>
    </div>
  );
};

export default LanguageSelector;
/* SPDX-License-Identifier: MIT OR Apache-2.0
 * Copyright (c) 2025 Guilherme Ferrari Brescia
 */

.quantum-spin {
  animation: quantumSpin 4.5s linear infinite;
}

@keyframes quantumSpin {
  100% {
    transform: rotate(360deg);
  }
}
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import { ConnectionState, MicrophoneState } from '../../../context';
import styles from './PanelHeader.module.css';
import QuantumSettingsIcon from './QuantumSettingsIcon';
import WifiStatusConnection from './WifiStatusConnection';

/**
 * Interface cortical para o cabe√ßalho do painel de transcri√ß√£o
 * Representa os controles principais de interface com usu√°rio
 * seguindo a est√©tica neural-simb√≥lica do Orch-OS
 */
interface PanelHeaderProps {
  onClose: () => void;
  onToggleDiagnostics: () => void;
  onShowImportModal: () => void;
  onShowLogsModal: () => void; // Abre o modal de logs de cogni√ß√£o
  onShowSettings?: () => void; // Abre as configura√ß√µes gerais do sistema
  onShowDebugModal?: () => void; // Abre o modal de debug DuckDB
  onMinimize?: () => void;
  connectionState: ConnectionState;
  microphoneState: MicrophoneState;
  hasActiveConnection?: () => boolean;
  onDisconnect?: () => void;
  onReconnect?: () => void;
}

const PanelHeader: React.FC<PanelHeaderProps> = ({
  onClose,
  onToggleDiagnostics,
  onShowImportModal,
  onShowLogsModal,
  onShowSettings,
  onShowDebugModal,
  onMinimize,
  connectionState,
  microphoneState,
  hasActiveConnection = () => false,
  onDisconnect,
  onReconnect
}) => {
  return (
    <div className="orchos-header-glass flex justify-between items-center mb-4 h-14 px-4">
      {/* Logo e T√≠tulo */}
      <h3 className="orchos-title font-bold text-xl tracking-wider flex items-center ml-2 orchos-header-gradient-text">
        <span className="mr-2 text-base">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <circle cx="10" cy="10" r="8" stroke="#00F0FF" strokeWidth="1.5" />
            <circle cx="10" cy="10" r="3" fill="#8F00FF" />
          </svg>
        </span>
        Orch-OS
      </h3>
      
      {/* Espa√ßo flex para empurrar os elementos para a direita */}
      <div className="flex-1"></div>
      
      {/* √Årea de todos os controles agrupados */}
      <div className="flex items-center gap-4 mr-2">
        {/* Bot√£o Import Neural Data */}
        <button
          title="Import Neural Data"
          onClick={onShowImportModal}
          className="flex items-center gap-2 px-4 py-1.5 rounded-full font-bold text-base bg-gradient-to-r from-cyan-400 via-blue-700 to-purple-600 shadow-[0_0_24px_4px_rgba(0,240,255,0.25)] hover:shadow-cyan-400/80 hover:scale-105 transition-all duration-200 ring-2 ring-cyan-400/30 backdrop-blur text-white focus:outline-none focus:ring-4 focus:ring-cyan-400/60 h-10"
        >
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none" aria-hidden="true">
            <circle cx="10" cy="10" r="8" stroke="#00F0FF" strokeWidth="1.5" />
            <path d="M10 6v5m0 0l2.5-2.5M10 11l-2.5-2.5" stroke="#8F00FF" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
          </svg>
          Import Neural Data
        </button>
        
        {/* Bot√£o Logs */}
        <button
          title="Cognition Logs"
          aria-label="Open Cognition Logs"
          onClick={onShowLogsModal}
          className="flex items-center gap-2 px-4 py-1.5 rounded-full font-bold text-base bg-gradient-to-r from-cyan-400 via-blue-700 to-purple-600 shadow-[0_0_24px_4px_rgba(0,240,255,0.25)] hover:shadow-cyan-400/80 hover:scale-105 transition-all duration-200 ring-2 ring-cyan-400/30 backdrop-blur text-white focus:outline-none focus:ring-4 focus:ring-cyan-400/60 h-10"
        >
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none" aria-hidden="true" style={{ display: 'inline', marginRight: 2, verticalAlign: 'middle', filter: 'drop-shadow(0 0 4px #00faff88)' }}>
            <ellipse cx="10" cy="10" rx="8" ry="6" stroke="#00F0FF" strokeWidth="2"/>
            <circle cx="10" cy="10" r="3" fill="#8F00FF"/>
          </svg>
          Logs
        </button>
        
        {/* Bot√£o Debug DuckDB - apenas em desenvolvimento */}
        {onShowDebugModal && process.env.NODE_ENV === 'development' && (
          <button
            title="DuckDB Debug (Dev Only)"
            aria-label="Open DuckDB Debug"
            onClick={onShowDebugModal}
            className="flex items-center gap-2 px-4 py-1.5 rounded-full font-bold text-base bg-gradient-to-r from-orange-400 via-red-500 to-purple-600 shadow-[0_0_24px_4px_rgba(255,165,0,0.25)] hover:shadow-orange-400/80 hover:scale-105 transition-all duration-200 ring-2 ring-orange-400/30 backdrop-blur text-white focus:outline-none focus:ring-4 focus:ring-orange-400/60 h-10"
          >
            <svg width="18" height="18" viewBox="0 0 20 20" fill="none" aria-hidden="true">
              <rect x="3" y="4" width="14" height="12" rx="2" stroke="#FFA500" strokeWidth="1.5" />
              <path d="M7 8h6M7 11h6M7 14h4" stroke="#FF4500" strokeWidth="1.5" strokeLinecap="round"/>
            </svg>
            Debug
          </button>
        )}
        
        {/* Bot√£o de Configura√ß√µes */}
        {onShowSettings && (
          <button
            title="Settings"
            onClick={onShowSettings}
            className={`flex items-center justify-center w-10 h-10 rounded-full bg-black/40 border border-cyan-500/40 hover:border-cyan-400/70 transition-all duration-200 ${styles['quantum-spin']}`}
          >
            <QuantumSettingsIcon size={26} />
          </button>
        )}
        
        {/* Indicador WiFi */}
        <WifiStatusConnection 
          connectionState={connectionState}
          microphoneState={microphoneState}
          signalStrength={hasActiveConnection() ? 'strong' : 'none'}
          onStatusClick={onToggleDiagnostics}
          showDetailedText={false}
          onDisconnect={onDisconnect}
          onReconnect={onReconnect}
        />
        
        {/* √Årea dos bot√µes de controle de janela com flexbox para alinhamento perfeito */}
        <div className="flex items-center gap-2 ml-4">
          {onMinimize && (
            <button
              title="Minimize"
              onClick={onMinimize}
              className="flex items-center justify-center w-10 h-10 rounded-full bg-black/40 border border-cyan-500/40 hover:border-cyan-400/70 transition-all duration-200"
            >
              <svg width="18" height="18" viewBox="0 0 22 22" fill="none">
                <circle cx="11" cy="11" r="8" stroke="#00faff" strokeWidth="1.5" strokeOpacity="0.8" />
                <rect x="6" y="10.5" width="10" height="1.5" rx="0.75" fill="#00faff" fillOpacity="0.9" />
              </svg>
            </button>
          )}
          <button
            title="Close"
            onClick={onClose}
            className="flex items-center justify-center w-10 h-10 rounded-full bg-black/40 border border-red-500/40 hover:border-red-400/70 transition-all duration-200"
          >
            <svg width="18" height="18" viewBox="0 0 22 22" fill="none">
              <circle cx="11" cy="11" r="8" stroke="#ff4455" strokeWidth="1.5" strokeOpacity="0.8" />
              <path d="M7.5 7.5L14.5 14.5M14.5 7.5L7.5 14.5" stroke="#ff4455" strokeWidth="1.5" strokeLinecap="round" strokeOpacity="0.9" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  );
};

export default PanelHeader;
// SPDX-License-Identifier: MIT OR Apache-2.0
// QuantumSettingsIcon.tsx - Epic quantum/futuristic settings icon for Orch-OS
// Inspired by Icons8 Futuristic Neon Gear, adapted for React

import React from "react";

interface QuantumSettingsIconProps {
  size?: number;
  className?: string;
}

const QuantumSettingsIcon: React.FC<QuantumSettingsIconProps> = ({ size = 28, className = "" }) => (
  <svg
    width={size}
    height={size}
    viewBox="0 0 64 64"
    fill="none"
    className={className}
    xmlns="http://www.w3.org/2000/svg"
    style={{
      filter: 'drop-shadow(0 0 6px #0ff) drop-shadow(0 0 18px #0ff)',
      background: 'transparent',
    }}
  >
    <circle cx="32" cy="32" r="30" stroke="#0ff" strokeWidth="2.5" fill="rgba(10,20,30,0.5)" />
    <g>
      <path
        d="M32 22a10 10 0 1 1 0 20 10 10 0 0 1 0-20zm0-8v4m0 28v4m12-12h4m-32 0h4m19.8-13.8l2.8-2.8m-23.6 23.6l2.8-2.8m0-18l-2.8-2.8m23.6 23.6-2.8-2.8"
        stroke="#0ff"
        strokeWidth="2.5"
        strokeLinecap="round"
        strokeLinejoin="round"
        style={{ filter: 'drop-shadow(0 0 4px #0ff)' }}
      />
    </g>
    <circle cx="32" cy="32" r="6.5" fill="#0ff" fillOpacity="0.18" />
    <circle cx="32" cy="32" r="4" fill="#0ff" fillOpacity="0.5" />
  </svg>
);

export default QuantumSettingsIcon;
/* SPDX-License-Identifier: MIT OR Apache-2.0
   Copyright (c) 2025 Guilherme Ferrari Brescia */

/* Base container - Neural activation container */

/* Neural activation button - Recording control */

/* Active recording state */

/* Inactive recording state */
.recordButtonInactive {
  border: 3px solid #00faff;
  box-shadow: 0 0 32px 8px rgba(0, 250, 255, 0.2);
}

/* Recording status indicator */

/* Pulse animation for active recording */
@keyframes pulse {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
  100% {
    opacity: 1;
  }
}
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import { MicrophoneState } from '../../../context';
import styles from './RecordingControl.module.css';

/**
 * Neural activation interface for audio recording control
 */
interface RecordingControlProps {
  microphoneState: MicrophoneState;
  toggleRecording: () => Promise<void>;
}

/**
 * Recording control component - Neural activation interface
 * Symbolic intent: Neural impulse control for audio signal capture
 */
const RecordingControl: React.FC<RecordingControlProps> = ({
  microphoneState,
  toggleRecording
}) => {
  return (
    <div className={styles.recordingContainer}>
      <button
        className={`orchos-btn-circular orchos-btn-fab orchos-btn-glass orchos-btn-ripple orchos-btn-rel flex items-center justify-center shadow-lg transition-all duration-200 ${styles.recordButton} ${
          microphoneState === MicrophoneState.Open 
            ? `${styles.recordButtonActive} animate-pulse` 
            : styles.recordButtonInactive
        }`}
        style={{
          border: microphoneState === MicrophoneState.Open ? '3px solid #ff4455' : '3px solid #00faff',
          boxShadow: microphoneState === MicrophoneState.Open ? '0 0 32px 8px rgba(255, 68, 85, 0.33)' : '0 0 32px 8px rgba(0, 250, 255, 0.2)'
        }}
        onClick={e => {
          // Create ripple effect - neural activation visualization
          const btn = e.currentTarget;
          const ripple = document.createElement('span');
          ripple.className = 'ripple orchos-ripple-electric';
          ripple.style.left = `${e.nativeEvent.offsetX}px`;
          ripple.style.top = `${e.nativeEvent.offsetY}px`;
          btn.appendChild(ripple);
          setTimeout(() => ripple.remove(), 600);
          toggleRecording();
        }}
        title={microphoneState === MicrophoneState.Open ? 'Stop Recording' : 'Start Recording'}
        aria-label={microphoneState === MicrophoneState.Open ? 'Stop Recording' : 'Start Recording'}
      >
        {microphoneState === MicrophoneState.Open ? (
          // √çcone de STOP neural (quadrado com pulso)
          <svg width="38" height="38" viewBox="0 0 38 38" fill="none" className="orchos-icon-glow">
            <ellipse cx="19" cy="19" rx="16" ry="12" stroke="#ff4455" strokeWidth="2.5"/>
            <rect x="13" y="13" width="12" height="12" rx="3" fill="#ff4455"/>
            <path d="M19 7 L19 3" stroke="#ff4455" strokeWidth="2" strokeLinecap="round"/>
            <circle cx="19" cy="3" r="1.3" fill="#ff4455"/>
            <path d="M17 19 Q19 23 21 19" stroke="#ff4455" strokeWidth="1.5" fill="none"/>
          </svg>
        ) : (
          // √çcone de microfone neural (START)
          <svg width="38" height="38" viewBox="0 0 38 38" fill="none" className="orchos-icon-glow">
            <ellipse cx="19" cy="19" rx="16" ry="12" stroke="#00faff" strokeWidth="2.5"/>
            <rect x="16" y="11" width="6" height="14" rx="3" fill="#00faff"/>
            <rect x="17.5" y="25" width="3" height="3" rx="1.5" fill="#00faff"/>
            <path d="M19 7 L19 3" stroke="#00faff" strokeWidth="2" strokeLinecap="round"/>
            <circle cx="19" cy="3" r="1.3" fill="#00faff"/>
            <path d="M17 19 Q19 23 21 19" stroke="#00faff" strokeWidth="1.5" fill="none"/>
          </svg>
        )}
      </button>
      {/* Neural state indicator - active recording status */}
      {microphoneState === MicrophoneState.Open && (
        <div className={styles.recordingLabel}>
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" className="inline mr-1 align-text-bottom">
            <ellipse cx="9" cy="9" rx="7" ry="5" stroke="#ff4455" strokeWidth="1.5"/>
            <circle cx="9" cy="9" r="2" fill="#ff4455"/>
          </svg>
          Recording...
        </div>
      )}
    </div>
  );
};

export default RecordingControl;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";
import { AudioSettings, GeneralSettings, InterfaceSettings } from "./settings";
import ApiSettings from "./settings/ApiSettings";
import SettingsFooter from "./settings/SettingsFooter";
import SettingsHeader from "./settings/SettingsHeader";
import SettingsNavigation from "./settings/SettingsNavigation";
import { SettingsModalProps } from "./settings/types";
import { useSettingsState } from "./settings/useSettingsState";

/**
 * Modal de configura√ß√µes do Orch-OS
 * Refatorado seguindo os princ√≠pios neural-simb√≥licos:
 * - Clean Architecture (separa√ß√£o de responsabilidades)
 * - SOLID (componentes com responsabilidade √∫nica)
 * - KISS (simplifica√ß√£o da l√≥gica)
 */
const SettingsModal: React.FC<SettingsModalProps> = ({ show, onClose }) => {
  // Usando o hook customizado para gerenciar todo o estado
  const settings = useSettingsState(show);

  // Se n√£o for exibido, n√£o renderizar nada
  if (!show) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/60">
      <div className="bg-gray-900/90 rounded-2xl shadow-2xl p-6 w-full max-w-2xl relative backdrop-blur-lg ring-2 ring-cyan-400/10">
        {/* Cabe√ßalho */}
        <SettingsHeader onClose={onClose} />

        {/* Navega√ß√£o */}
        <SettingsNavigation
          activeTab={settings.activeTab}
          setActiveTab={settings.setActiveTab}
        />

        {/* Conte√∫do das abas */}
        <div className="mb-4">
          {/* General Tab */}
          {settings.activeTab === "general" && (
            <GeneralSettings
              name={settings.name}
              setName={settings.setName}
              applicationMode={settings.applicationMode}
              setApplicationMode={settings.setApplicationMode}
              enableMatrix={settings.enableMatrix}
              setEnableMatrix={settings.setEnableMatrix}
              matrixDensity={settings.matrixDensity}
              setMatrixDensity={settings.setMatrixDensity}
              enableEffects={settings.enableEffects}
              setEnableEffects={settings.setEnableEffects}
              enableAnimations={settings.enableAnimations}
              setEnableAnimations={settings.setEnableAnimations}
            />
          )}

          {/* Interface Tab */}
          {settings.activeTab === "interface" && (
            <InterfaceSettings
              darkMode={settings.darkMode}
              setDarkMode={settings.setDarkMode}
              enableNeumorphism={settings.enableNeumorphism}
              setEnableNeumorphism={settings.setEnableNeumorphism}
              enableGlassmorphism={settings.enableGlassmorphism}
              setEnableGlassmorphism={settings.setEnableGlassmorphism}
              panelTransparency={settings.panelTransparency}
              setPanelTransparency={settings.setPanelTransparency}
              colorTheme={settings.colorTheme}
              setColorTheme={settings.setColorTheme}
            />
          )}

          {/* Audio Tab */}
          {settings.activeTab === "audio" && (
            <AudioSettings
              enhancedPunctuation={settings.enhancedPunctuation}
              setEnhancedPunctuation={settings.setEnhancedPunctuation}
              speakerDiarization={settings.speakerDiarization}
              setSpeakerDiarization={settings.setSpeakerDiarization}
              audioQuality={settings.audioQuality}
              setAudioQuality={settings.setAudioQuality}
              autoGainControl={settings.autoGainControl}
              setAutoGainControl={settings.setAutoGainControl}
              noiseSuppression={settings.noiseSuppression}
              setNoiseSuppression={settings.setNoiseSuppression}
              echoCancellation={settings.echoCancellation}
              setEchoCancellation={settings.setEchoCancellation}
            />
          )}

          {/* Advanced Tab */}
          {settings.activeTab === "advanced" && (
            <ApiSettings
              applicationMode={settings.applicationMode}
              setApplicationMode={settings.setApplicationMode}
              ollamaModel={settings.ollamaModel}
              setOllamaModel={settings.setOllamaModel}
              ollamaEmbeddingModel={settings.ollamaEmbeddingModel}
              setOllamaEmbeddingModel={settings.setOllamaEmbeddingModel}
              ollamaEnabled={settings.ollamaEnabled}
              setOllamaEnabled={settings.setOllamaEnabled}
            />
          )}
        </div>

        {/* Footer com bot√µes de a√ß√£o */}
        <SettingsFooter
          onClose={onClose}
          saveSettings={settings.saveSettings}
        />
      </div>
    </div>
  );
};

export default SettingsModal;
/* SPDX-License-Identifier: MIT OR Apache-2.0
 * Copyright (c) 2025 Guilherme Ferrari Brescia
 */

.orchos-btn-glass {
  background: rgba(24, 24, 40, 0.55);
  border: 2px solid #00faff;
  border-radius: 999px !important;
  box-shadow: 0 0 12px 2px #00faff44, 0 0 0 1.5px #00faff22;
  color: #00faff;
  transition: box-shadow 0.18s, background 0.18s, border-color 0.18s;
}
.orchos-btn-glass:focus,
.orchos-btn-glass:hover {
  background: rgba(0, 245, 255, 0.12);
  box-shadow: 0 0 16px 4px #00faff77, 0 0 0 2.5px #00faff55;
  border-color: #00faff;
}

.orchos-btn-glow {
  box-shadow: 0 0 8px 2px #00faff77;
}

.orchos-btn-action {
  font-weight: 500;
  font-size: 0.9rem;
  border-radius: 999px !important;
  padding-left: 0.9em;
  padding-right: 0.9em;
  min-height: 32px;
  min-width: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import styles from './TextControls.module.css';

interface TextControlsProps {
  label: string;
  onClear: () => void;
  onExpand?: () => void;
  isExpanded?: boolean;
}

const TextControls: React.FC<TextControlsProps> = ({ label, onClear, onExpand, isExpanded }) => (
  <div className="flex justify-between items-center py-1 mb-2 flex-wrap">
    <h4 className="text-sm font-medium">{label}</h4>
    <div className="flex gap-2 flex-wrap">

      {onExpand && (
        <button
          className={`${styles['orchos-btn-glass']} ${styles['orchos-btn-glow']} ${styles['orchos-btn-action']} px-2.5 py-1.5 transition-all duration-150 flex items-center justify-center group`}
          onClick={(e) => {
            e.preventDefault();
            e.stopPropagation();
            onExpand();
          }}
          title={isExpanded ? "Collapse" : "Expand"}
          aria-label={isExpanded ? "Collapse" : "Expand"}
        >
          <svg width="17" height="17" viewBox="0 0 17 17" fill="none"><ellipse cx="8.5" cy="8.5" rx="7.5" ry="5.5" stroke="#00faff" strokeWidth="1.3"/><path d="M5 6l3.5 3.5L12 6" stroke="#00faff" strokeWidth="1.2" fill="none"/></svg>
          <span className="hidden md:inline ml-1 align-middle">{isExpanded ? "Collapse" : "Expand"}</span>
        </button>
      )}
      <button
        className={`${styles['orchos-btn-glass']} ${styles['orchos-btn-glow']} ${styles['orchos-btn-action']} px-2.5 py-1.5 transition-all duration-150 flex items-center justify-center group`}
        onClick={onClear}
        title="Clear text"
        aria-label="Clear text"
      >
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><ellipse cx="8" cy="8" rx="6.5" ry="4.5" stroke="#ff4dd2" strokeWidth="1.2"/><path d="M6 6l4 4M10 6l-4 4" stroke="#ff4dd2" strokeWidth="1.3" strokeLinecap="round"/></svg>
        <span className="hidden md:inline ml-1 align-middle">Clear</span>
      </button>
    </div>
  </div>
);

export default TextControls;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from 'react';
import TextControls from './TextControls';


interface TextEditorProps {
  label: string;
  value: string;
  onChange: (value: string) => void;
  onClear: () => void;
  rows?: number;
  placeholder?: string;
  isExpanded?: boolean;
  toggleExpand?: () => void;
  forwardedRef?: React.RefObject<HTMLTextAreaElement>;
  useAutosize?: boolean;
  readOnly?: boolean;
}

const TextEditor: React.FC<TextEditorProps> = ({
  label,
  value,
  onChange,
  onClear,
  rows = 5,
  placeholder = '',
  isExpanded,
  toggleExpand,
  forwardedRef,
  useAutosize = true,
  readOnly = false
}) => {

  // Classes comuns para todos os textareas, adaptando-se ao contexto neural
  const commonClasses = `w-full p-4 rounded-xl bg-black/40 text-white leading-relaxed font-medium shadow-inner neural-adaptive-container`;

  return (
    <div className="flex-1 flex flex-col min-h-0 neural-text-container">
      <TextControls
        label={label}
        onClear={onClear}
        onExpand={toggleExpand}
      />
      
      {useAutosize ? (
        <textarea
          className={`${commonClasses} orchos-textarea-neural resize-none flex-1 h-full min-h-0 ${isExpanded ? 'max-h-96' : ''} overflow-y-auto`}
          value={value}
          onChange={(e) => { if (!readOnly) onChange(e.target.value); }}
          readOnly={readOnly}
          rows={isExpanded ? 10 : rows}
          ref={forwardedRef}
          placeholder={placeholder}
          title={readOnly ? "Transcription text (read-only)" : label}
          aria-label={readOnly ? "Transcription text (read-only)" : label}
          style={{ height: '100%', minHeight: '60px' }}
        />
      ) : (
        <textarea
          className={`${commonClasses} orchos-textarea-neural resize-none flex-1 h-full min-h-0`}
          value={value}
          onChange={(e) => { if (!readOnly) onChange(e.target.value); }}
          readOnly={readOnly}
          rows={rows}
          ref={forwardedRef}
          placeholder={placeholder}
          title={readOnly ? "Transcription text (read-only)" : label}
          aria-label={readOnly ? "Transcription text (read-only)" : label}
          style={{ height: '100%', minHeight: '60px' }}
        />
      )}
    </div>
  );
};

export default TextEditor;
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React from "react";

interface ToggleSwitchProps {
  label: string;
  isOn: boolean;
  onChange: () => void;
  title: string;
}

const ToggleSwitch: React.FC<ToggleSwitchProps> = ({
  label,
  isOn,
  onChange,
  title,
}) => (
  <div className="flex items-center justify-between py-3">
    <span className="text-sm text-gray-300 font-medium">{label}</span>
    <button
      type="button"
      title={title}
      onClick={onChange}
      className="relative h-7 w-12 rounded-full transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-offset-2 focus:ring-offset-gray-900"
      style={{
        backgroundColor: isOn ? "#00D9FF" : "#374151",
        boxShadow: isOn
          ? "inset 0 0 0 2px rgba(255, 255, 255, 0.5), inset 0 0 0 1px rgba(0, 217, 255, 1), 0 0 12px rgba(0, 217, 255, 0.5), 0 0 4px rgba(0, 217, 255, 0.8)"
          : "inset 0 0 0 2px rgba(255, 255, 255, 0.1), inset 0 0 0 1px rgba(156, 163, 175, 0.5), 0 1px 2px rgba(0, 0, 0, 0.1)",
      }}
      aria-label={`${label}: ${isOn ? "on" : "off"}`}
    >
      <div
        className="absolute top-[2px] h-[22px] w-[22px] rounded-full transition-transform duration-200 ease-in-out"
        style={{
          transform: isOn ? "translateX(22px)" : "translateX(2px)",
          backgroundColor: "#FFFFFF",
          boxShadow: isOn
            ? "inset 0 0 0 2px rgba(0, 217, 255, 0.6), 0 3px 5px rgba(0, 0, 0, 0.3), 0 0 8px rgba(0, 217, 255, 0.4)"
            : "inset 0 0 0 1px rgba(156, 163, 175, 0.3), 0 3px 5px rgba(0, 0, 0, 0.2), 0 0 0 0.5px rgba(0, 0, 0, 0.08)",
        }}
      />
    </button>
  </div>
);

export default ToggleSwitch;
/* SPDX-License-Identifier: MIT OR Apache-2.0
   Copyright (c) 2025 Guilherme Ferrari Brescia */

/* Base Styles - Neural Signal Connectivity Interface */
.wifiStatusConnection {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  position: relative;
}

/* Neural Icon Container */
.wifiIconContainer {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 28px;
  width: 28px;
  margin-right: 0.5rem;
  margin-left: 0.25rem;
}

/* Container para o painel de diagn√≥sticos */
.diagnosticsPanelContainer {
  position: absolute;
  top: 100%;
  right: -40px;
  margin-top: 0.5rem;
  z-index: 50;
  filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));
  animation: fadeInPanel 0.2s ease-out;
}

@keyframes fadeInPanel {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Neural Signal Icon Base */
.neuralSignalIcon {
  overflow: visible; /* Allow glow effects to extend beyond SVG boundaries */
  transform: scale(1.05); /* Slightly larger to enhance visibility */
}

/* Neural Field Animation */
@keyframes neuralFieldPulse {
  0% {
    opacity: 0.05;
    transform: scale(1);
  }
  50% {
    opacity: 0.15;
    transform: scale(1.05);
  }
  100% {
    opacity: 0.05;
    transform: scale(1);
  }
}

.neuralField {
  transform-origin: center;
}

.neuralFieldActive {
  animation: neuralFieldPulse 3s infinite ease-in-out;
}

/* Neural Connection States - Color Definitions */
:global(.wifi-status-fully-connected) .neuralSignalIcon {
  color: #00faff; /* Cyan - Neural connection fully active */
  filter: drop-shadow(0 0 5px rgba(0, 250, 255, 0.9)) drop-shadow(0 0 10px rgba(0, 250, 255, 0.5));
}

:global(.wifi-status-partially-connected) .neuralSignalIcon {
  color: #00e1f0; /* Ciano mais vibrante - Neural connection partially active */
  filter: drop-shadow(0 0 4px rgba(0, 225, 240, 0.7)) drop-shadow(0 0 8px rgba(0, 225, 240, 0.4));
}

:global(.wifi-status-connecting) .neuralSignalIcon {
  color: #ffe066; /* Yellow - Neural connection forming */
  filter: drop-shadow(0 0 4px rgba(255, 224, 102, 0.7)) drop-shadow(0 0 8px rgba(255, 224, 102, 0.4));
}

:global(.wifi-status-error) .neuralSignalIcon {
  color: #ff4455; /* Red - Neural connection disrupted */
  filter: drop-shadow(0 0 4px rgba(255, 68, 85, 0.7)) drop-shadow(0 0 8px rgba(255, 68, 85, 0.4));
}

:global(.wifi-status-disconnected) .neuralSignalIcon,
:global(.wifi-status-unknown) .neuralSignalIcon {
  color: #aaaaaa; /* Cinza mais claro para melhor visibilidade quando desconectado */
  filter: drop-shadow(0 0 3px rgba(170, 170, 170, 0.6)) drop-shadow(0 0 5px rgba(170, 170, 170, 0.3));
}

/* Neural Ring Animation */
@keyframes neuralRingPulse {
  0% {
    stroke-opacity: 0.7;
    stroke-width: 1.5;
  }
  50% {
    stroke-opacity: 1;
    stroke-width: 2;
  }
  100% {
    stroke-opacity: 0.7;
    stroke-width: 1.5;
  }
}

.neuralRing {
  transition: all 0.3s ease-in-out;
  transform-origin: center center;
}

.neuralRingActive {
  animation: neuralRingPulse 3s infinite ease-in-out;
}

/* Neural Wave Animation */
@keyframes neuralWavePulse {
  0% {
    stroke-opacity: 0.7;
    transform: translateY(0);
  }
  50% {
    stroke-opacity: 1;
    transform: translateY(-0.5px);
  }
  100% {
    stroke-opacity: 0.7;
    transform: translateY(0);
  }
}

.neuralWave {
  stroke-opacity: 0.7;
  transform-origin: center;
}

:global(.wifi-status-fully-connected) .neuralWave {
  animation: neuralWavePulse 2.5s infinite ease-in-out;
}

/* Neural Core Animation */
@keyframes neuralCorePulse {
  0% {
    opacity: 0.8;
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(1.1);
  }
  100% {
    opacity: 0.8;
    transform: scale(1);
  }
}

.neuralCore {
  transform-origin: center;
}

.neuralCoreActive {
  animation: neuralCorePulse 2s infinite ease-in-out;
}

/* Inner Core Animation */
@keyframes neuralInnerCorePulse {
  0% {
    opacity: 0.8;
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(1.2);
  }
  100% {
    opacity: 0.8;
    transform: scale(1);
  }
}

.neuralInnerCore {
  transform-origin: center;
  animation: neuralInnerCorePulse 1.5s infinite ease-in-out;
}

/* Status Text Styling */
.statusText {
  margin-left: 0.25rem;
  font-size: 0.75rem;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  letter-spacing: 0.02em;
  transition: color 0.3s ease;
}

/* Status text styling */
.statusText {
  font-size: 0.75rem;
}

.statusConnected {
  color: var(--color-green-400);
}

.statusConnecting {
  color: var(--color-yellow-400);
}

.statusDisconnected {
  color: var(--color-red-400);
}

.statusUnknown {
  color: var(--color-gray-400);
}
// SPDX-License-Identifier: MIT OR Apache-2.0
// Copyright (c) 2025 Guilherme Ferrari Brescia

import React, { useState, useRef, useEffect } from 'react';
import { ConnectionState, MicrophoneState } from '../../../context';
import styles from './WifiStatusConnection.module.css';
import DiagnosticsPanel from './DiagnosticsPanel';

interface WifiStatusConnectionProps {
  connectionState: ConnectionState;
  microphoneState: MicrophoneState;
  signalStrength?: 'strong' | 'medium' | 'weak' | 'none';
  onStatusClick?: () => void;
  showDetailedText?: boolean;
  className?: string;
  onDisconnect?: () => void;
  onReconnect?: () => void;
}

/**
 * Neural signal visualization component for connection state
 * Symbolic intent: Interface neuron for connectivity visualization
 */
const WifiStatusConnection: React.FC<WifiStatusConnectionProps> = ({ 
  connectionState, 
  microphoneState, 
  signalStrength = 'medium',
  onStatusClick,
  showDetailedText = false,
  className = '',
  onDisconnect,
  onReconnect
}) => {
  // Estado para controlar a visibilidade do painel de diagn√≥sticos
  const [showDiagnostics, setShowDiagnostics] = useState(false);
  const diagnosticsPanelRef = useRef<HTMLDivElement>(null);
  const iconRef = useRef<HTMLDivElement>(null);
  
  // Gerencia cliques fora do painel para fech√°-lo
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (
        showDiagnostics && 
        diagnosticsPanelRef.current && 
        !diagnosticsPanelRef.current.contains(event.target as Node) &&
        iconRef.current &&
        !iconRef.current.contains(event.target as Node)
      ) {
        setShowDiagnostics(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => {
      document.removeEventListener('mousedown', handleClickOutside);
    };
  }, [showDiagnostics]);
  
  // Alterna a visibilidade do painel de diagn√≥sticos
  const toggleDiagnosticsPanel = () => {
    setShowDiagnostics(prev => !prev);
  };

  // Determinar se o sistema est√° completamente conectado (Deepgram + microfone)
  const isFullyConnected = () => {
    return (
      connectionState === ConnectionState.OPEN && 
      (microphoneState === MicrophoneState.Open || microphoneState === MicrophoneState.Ready)
    );
  };

  // Determinar se h√° erros em qualquer subsistema
  const hasErrors = () => {
    return (
      connectionState === ConnectionState.ERROR || 
      microphoneState === MicrophoneState.Error
    );
  };

  // Determinar se est√° em processo de conex√£o
  const isConnecting = () => {
    return (
      connectionState === ConnectionState.CONNECTING ||
      microphoneState === MicrophoneState.Opening ||
      microphoneState === MicrophoneState.SettingUp
    );
  };

  // Convert connection state to user-friendly message
  const getConnectionStatusText = () => {
    if (isFullyConnected()) {
      return 'Fully Connected';
    } else if (hasErrors()) {
      return 'Connection Error';
    } else if (isConnecting()) {
      return 'Connecting...';
    } else if (connectionState === ConnectionState.OPEN) {
      return 'Deepgram Connected';
    } else if (microphoneState === MicrophoneState.Ready || microphoneState === MicrophoneState.Open) {
      return 'Microphone Ready';
    } else if (connectionState === ConnectionState.CLOSED || connectionState === ConnectionState.STOPPED) {
      return 'Disconnected';
    } else {
      return 'Unknown State';
    }
  };

  // Determine colors based on combined connection state
  const getConnectionColors = () => {
    if (isFullyConnected()) {
      // Ambos conectados - verde ciano
      return {
        primary: '#00faff',
        secondary: 'rgba(0, 250, 255, 0.8)',
        glow: 'rgba(0, 250, 255, 0.5)',
        textColor: 'text-green-400'
      };
    } else if (hasErrors()) {
      // Erros - vermelho
      return {
        primary: '#ff4455',
        secondary: 'rgba(255, 68, 85, 0.8)',
        glow: 'rgba(255, 68, 85, 0.5)',
        textColor: 'text-red-400'
      };
    } else if (isConnecting()) {
      // Conectando - amarelo
      return {
        primary: '#ffe066',
        secondary: 'rgba(255, 224, 102, 0.8)',
        glow: 'rgba(255, 224, 102, 0.5)',
        textColor: 'text-yellow-400'
      };
    } else if (connectionState === ConnectionState.OPEN || 
               microphoneState === MicrophoneState.Ready || 
               microphoneState === MicrophoneState.Open) {
      // Parcialmente conectado - ciano mais fraco
      return {
        primary: '#00c8d4',
        secondary: 'rgba(0, 200, 212, 0.8)',
        glow: 'rgba(0, 200, 212, 0.5)',
        textColor: 'text-cyan-400'
      };
    } else {
      // Desconectado ou estado desconhecido - cinza
      return {
        primary: '#888888',
        secondary: 'rgba(136, 136, 136, 0.8)',
        glow: 'rgba(136, 136, 136, 0.5)',
        textColor: 'text-gray-400'
      };
    }
  };

  // Get color variables for the component
  const colors = getConnectionColors();
  const statusText = getConnectionStatusText();

  // Determine which bars should be active based on connection status and signal strength
  const getSignalBars = () => {
    // Se ambos estiverem conectados, use a for√ßa do sinal fornecida
    if (isFullyConnected()) {
      switch (signalStrength) {
        case 'strong':
          return [true, true, true];
        case 'medium':
          return [true, true, false];
        case 'weak':
          return [true, false, false];
        default:
          return [true, true, true]; // Por padr√£o, mostra sinal forte quando conectado
      }
    } 
    // Se estiver conectando, mostra sinal m√©dio
    else if (isConnecting()) {
      return [true, true, false];
    }
    // Se apenas um dos sistemas estiver conectado, mostra sinal fraco
    else if (connectionState === ConnectionState.OPEN || 
             microphoneState === MicrophoneState.Ready || 
             microphoneState === MicrophoneState.Open) {
      return [true, false, false];
    }
    // Se estiver desconectado ou com erro, n√£o mostra sinal
    else {
      return [false, false, false];
    }
  };

  const signalBars = getSignalBars();

  // Generate dynamic classNames based on combined connection state
  const getConnectionStateClass = () => {
    if (isFullyConnected()) {
      return 'wifi-status-fully-connected';
    } else if (hasErrors()) {
      return 'wifi-status-error';
    } else if (isConnecting()) {
      return 'wifi-status-connecting';
    } else if (connectionState === ConnectionState.OPEN || 
               microphoneState === MicrophoneState.Ready || 
               microphoneState === MicrophoneState.Open) {
      return 'wifi-status-partially-connected';
    } else if (connectionState === ConnectionState.CLOSED || connectionState === ConnectionState.STOPPED) {
      return 'wifi-status-disconnected';
    } else {
      return 'wifi-status-unknown';
    }
  };

  // Add dynamic classes based on connection state
  const connectionStateClass = getConnectionStateClass();
  
  // Determine CSS classes for status text
  const getStatusTextClass = () => {
    switch (connectionState) {
      case ConnectionState.OPEN:
        return styles.statusConnected;
      case ConnectionState.CONNECTING:
        return styles.statusConnecting;
      case ConnectionState.CLOSED:
      case ConnectionState.ERROR:
      case ConnectionState.STOPPED:
        return styles.statusDisconnected;
      default:
        return styles.statusUnknown;
    }
  };

  return (
    <div 
      className={`${styles.wifiStatusConnection} ${connectionStateClass} ${className}`}
      title={statusText}
      ref={iconRef}
      onClick={toggleDiagnosticsPanel}
    >
      {/* Painel de diagn√≥sticos flutuante */}
      {showDiagnostics && (
        <div 
          className={styles.diagnosticsPanelContainer} 
          ref={diagnosticsPanelRef}
          onClick={(e) => e.stopPropagation()}
        >
          <DiagnosticsPanel 
            connectionState={connectionState} 
            microphoneState={microphoneState}
            onDisconnect={onDisconnect}
            onReconnect={onReconnect}
          />
        </div>
      )}
      <div className={styles.wifiIconContainer}>
        {/* WiFi icon with neural aesthetic for Orch-OS */}
        <svg width="26" height="26" viewBox="0 0 26 26" fill="none" className={styles.neuralSignalIcon}>
          {/* Outer ring with neural aesthetic */}
          <circle 
            cx="13" 
            cy="13" 
            r="11" 
            className={`${styles.neuralRing} ${isFullyConnected() ? styles.neuralRingActive : ''}`} 
            stroke="currentColor" 
            strokeWidth="1.5" 
            strokeOpacity={isFullyConnected() ? "1" : isConnecting() ? "0.8" : "0.6"}
            fill="transparent"
          />
          
          {/* WiFi signal wave - upper arc - always visible but with varied opacity */}
          <path 
            d="M6.5 13 A9 9 0 0 1 19.5 13" 
            className={styles.neuralWave} 
            stroke="currentColor" 
            strokeWidth="1.5" 
            strokeLinecap="round"
            strokeOpacity={signalBars[0] ? "1" : "0.25"}
          />
          
          {/* WiFi signal wave - lower arc - always visible but with varied opacity */}
          <path 
            d="M9 16.5 A6 6 0 0 1 17 16.5" 
            className={styles.neuralWave} 
            stroke="currentColor" 
            strokeWidth="1.5" 
            strokeLinecap="round"
            strokeOpacity={signalBars[1] ? "1" : "0.25"}
          />
          
          {/* Central signal point - always visible but with varied opacity */}
          <circle 
            cx="13" 
            cy="19.5" 
            r="1.8" 
            className={`${styles.neuralCore} ${isFullyConnected() ? styles.neuralCoreActive : ''}`} 
            fill="currentColor" 
            fillOpacity={signalBars[2] ? "1" : "0.25"}
          />
        </svg>
      </div>
      
      {showDetailedText && (
        <span className={`${styles.statusText} ${getStatusTextClass()}`}>
          {statusText}
        </span>
      )}
    </div>
  );
};
